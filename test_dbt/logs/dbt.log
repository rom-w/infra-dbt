

============================== 2023-02-08 12:55:24.054992 | 378cdb66-db03-44fb-82a0-1523bf630edd ==============================
[0m12:55:24.054992 [info ] [MainThread]: Running with dbt=1.4.1
[0m12:55:24.057383 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/afinkelstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:55:24.057615 [debug] [MainThread]: Tracking: tracking
[0m12:55:24.080758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10925b2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092650d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092652b0>]}
[0m12:55:24.279068 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:55:24.279703 [debug] [MainThread]: Partial parsing: updated file: test_dbt://models/example/metrics.yml
[0m12:55:24.296366 [debug] [MainThread]: 1603: static parser failed on example/metric_test.sql
[0m12:55:24.362940 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/metric_test.sql
[0m12:55:24.391365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '378cdb66-db03-44fb-82a0-1523bf630edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095f53a0>]}
[0m12:55:24.403171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '378cdb66-db03-44fb-82a0-1523bf630edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fef5e0>]}
[0m12:55:24.403844 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 515 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 2 metrics
[0m12:55:24.404188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '378cdb66-db03-44fb-82a0-1523bf630edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10925ef70>]}
[0m12:55:24.405624 [info ] [MainThread]: 
[0m12:55:24.407394 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:55:24.408431 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_dbt'
[0m12:55:24.421645 [debug] [ThreadPool]: Using postgres connection "list_test_dbt"
[0m12:55:24.422232 [debug] [ThreadPool]: On list_test_dbt: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "list_test_dbt"} */

    select distinct nspname from pg_namespace
  
[0m12:55:24.422456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:24.475382 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m12:55:24.476943 [debug] [ThreadPool]: On list_test_dbt: Close
[0m12:55:24.478819 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_dbt_public'
[0m12:55:24.486182 [debug] [ThreadPool]: Using postgres connection "list_test_dbt_public"
[0m12:55:24.486519 [debug] [ThreadPool]: On list_test_dbt_public: BEGIN
[0m12:55:24.486757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:55:24.510862 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m12:55:24.511209 [debug] [ThreadPool]: Using postgres connection "list_test_dbt_public"
[0m12:55:24.511450 [debug] [ThreadPool]: On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "list_test_dbt_public"} */
select
      'test_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m12:55:24.530104 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m12:55:24.531505 [debug] [ThreadPool]: On list_test_dbt_public: ROLLBACK
[0m12:55:24.533119 [debug] [ThreadPool]: On list_test_dbt_public: Close
[0m12:55:24.539943 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:24.540287 [debug] [MainThread]: On master: BEGIN
[0m12:55:24.540525 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:55:24.562622 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:55:24.562976 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:24.563213 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:55:24.595301 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m12:55:24.598255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '378cdb66-db03-44fb-82a0-1523bf630edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109516c70>]}
[0m12:55:24.598870 [debug] [MainThread]: On master: ROLLBACK
[0m12:55:24.600749 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:24.601111 [debug] [MainThread]: On master: BEGIN
[0m12:55:24.603662 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:55:24.603997 [debug] [MainThread]: On master: COMMIT
[0m12:55:24.604283 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:24.604547 [debug] [MainThread]: On master: COMMIT
[0m12:55:24.606263 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:55:24.606582 [debug] [MainThread]: On master: Close
[0m12:55:24.607246 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m12:55:24.607611 [info ] [MainThread]: 
[0m12:55:24.612848 [debug] [Thread-1  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m12:55:24.613220 [debug] [Thread-2  ]: Began running node model.test_dbt.my_first_dbt_model
[0m12:55:24.613659 [info ] [Thread-1  ]: 1 of 4 START sql table model public.dbt_metrics_default_calendar ............... [RUN]
[0m12:55:24.614134 [info ] [Thread-2  ]: 2 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m12:55:24.614858 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.metrics.dbt_metrics_default_calendar'
[0m12:55:24.615456 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.test_dbt.my_first_dbt_model'
[0m12:55:24.615766 [debug] [Thread-1  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m12:55:24.616085 [debug] [Thread-2  ]: Began compiling node model.test_dbt.my_first_dbt_model
[0m12:55:24.642317 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:55:24.645377 [debug] [Thread-2  ]: Writing injected SQL for node "model.test_dbt.my_first_dbt_model"
[0m12:55:24.645719 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: BEGIN
[0m12:55:24.646109 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:55:24.646555 [debug] [Thread-2  ]: Timing info for model.test_dbt.my_first_dbt_model (compile): 2023-02-08 12:55:24.642609 => 2023-02-08 12:55:24.646477
[0m12:55:24.646852 [debug] [Thread-2  ]: Began executing node model.test_dbt.my_first_dbt_model
[0m12:55:24.677698 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m12:55:24.688299 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:55:24.693963 [debug] [Thread-2  ]: Writing runtime sql for node "model.test_dbt.my_first_dbt_model"
[0m12:55:24.694273 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 
        ((cast('2030-01-01' as date))::date - (cast('1990-01-01' as date))::date)
    
[0m12:55:24.695020 [debug] [Thread-2  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:55:24.695341 [debug] [Thread-2  ]: On model.test_dbt.my_first_dbt_model: BEGIN
[0m12:55:24.695603 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:55:24.696538 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m12:55:24.714139 [debug] [Thread-1  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m12:55:24.715374 [debug] [Thread-1  ]: Timing info for model.metrics.dbt_metrics_default_calendar (compile): 2023-02-08 12:55:24.616318 => 2023-02-08 12:55:24.715262
[0m12:55:24.715781 [debug] [Thread-1  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m12:55:24.721469 [debug] [Thread-1  ]: Writing runtime sql for node "model.metrics.dbt_metrics_default_calendar"
[0m12:55:24.721727 [debug] [Thread-2  ]: SQL status: BEGIN in 0 seconds
[0m12:55:24.722149 [debug] [Thread-2  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:55:24.722422 [debug] [Thread-2  ]: On model.test_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_first_dbt_model"} */

  
    

  create  table "test_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id,'alexey' as name, '1991-01-01' as date_id, 97 score
    union all
    select 1 as id,'alexey' as name, '1991-01-02' as date_id, 66 score
    union all
    select 2 as id,'sergey' as name, '1991-01-03' as date_id, 50 score

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m12:55:24.722638 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:55:24.722959 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */

  
    

  create  table "test_dbt"."public"."dbt_metrics_default_calendar__dbt_tmp"
  as (
    

with days as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
    
    

    )

    select *
    from unioned
    where generated_number <= 14610
    order by generated_number



),

all_periods as (

    select (
        

    cast('1990-01-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2030-01-01' as date)

)

select * from filtered


),

final as (
    select 
        cast(date_day as date) as date_day,
        cast(date_trunc('week', date_day) as date) as date_week,
        cast(date_trunc('month', date_day) as date) as date_month,
        cast(date_trunc('quarter', date_day) as date) as date_quarter,
        cast(date_trunc('year', date_day) as date) as date_year
    from days
)

select * from final
  );
  
[0m12:55:24.754558 [debug] [Thread-2  ]: SQL status: SELECT 3 in 0 seconds
[0m12:55:24.761757 [debug] [Thread-2  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:55:24.762172 [debug] [Thread-2  ]: On model.test_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_first_dbt_model"} */
alter table "test_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m12:55:24.764073 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0 seconds
[0m12:55:24.767570 [debug] [Thread-2  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:55:24.767839 [debug] [Thread-2  ]: On model.test_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_first_dbt_model"} */
alter table "test_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:55:24.769484 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0 seconds
[0m12:55:24.797678 [debug] [Thread-2  ]: On model.test_dbt.my_first_dbt_model: COMMIT
[0m12:55:24.798001 [debug] [Thread-2  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:55:24.798270 [debug] [Thread-2  ]: On model.test_dbt.my_first_dbt_model: COMMIT
[0m12:55:24.804978 [debug] [Thread-2  ]: SQL status: COMMIT in 0 seconds
[0m12:55:24.811885 [debug] [Thread-2  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:55:24.812240 [debug] [Thread-2  ]: On model.test_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_first_dbt_model"} */
drop table if exists "test_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
[0m12:55:24.836587 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0 seconds
[0m12:55:24.838255 [debug] [Thread-2  ]: Timing info for model.test_dbt.my_first_dbt_model (execute): 2023-02-08 12:55:24.647048 => 2023-02-08 12:55:24.838195
[0m12:55:24.838615 [debug] [Thread-2  ]: On model.test_dbt.my_first_dbt_model: Close
[0m12:55:24.839332 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '378cdb66-db03-44fb-82a0-1523bf630edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10969ed00>]}
[0m12:55:24.839794 [info ] [Thread-2  ]: 2 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 3[0m in 0.22s]
[0m12:55:24.841277 [debug] [Thread-2  ]: Finished running node model.test_dbt.my_first_dbt_model
[0m12:55:24.842166 [debug] [Thread-4  ]: Began running node model.test_dbt.my_second_dbt_model
[0m12:55:24.842619 [info ] [Thread-4  ]: 3 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m12:55:24.843308 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.test_dbt.my_second_dbt_model'
[0m12:55:24.843581 [debug] [Thread-4  ]: Began compiling node model.test_dbt.my_second_dbt_model
[0m12:55:24.848690 [debug] [Thread-4  ]: Writing injected SQL for node "model.test_dbt.my_second_dbt_model"
[0m12:55:24.849513 [debug] [Thread-4  ]: Timing info for model.test_dbt.my_second_dbt_model (compile): 2023-02-08 12:55:24.843797 => 2023-02-08 12:55:24.849430
[0m12:55:24.849888 [debug] [Thread-4  ]: Began executing node model.test_dbt.my_second_dbt_model
[0m12:55:24.872647 [debug] [Thread-4  ]: Writing runtime sql for node "model.test_dbt.my_second_dbt_model"
[0m12:55:24.873749 [debug] [Thread-4  ]: Using postgres connection "model.test_dbt.my_second_dbt_model"
[0m12:55:24.874093 [debug] [Thread-4  ]: On model.test_dbt.my_second_dbt_model: BEGIN
[0m12:55:24.874327 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:55:24.896589 [debug] [Thread-4  ]: SQL status: BEGIN in 0 seconds
[0m12:55:24.896947 [debug] [Thread-4  ]: Using postgres connection "model.test_dbt.my_second_dbt_model"
[0m12:55:24.897165 [debug] [Thread-4  ]: On model.test_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_second_dbt_model"} */

  create view "test_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test_dbt"."public"."my_first_dbt_model"
where id = 1
  );
[0m12:55:24.912427 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0 seconds
[0m12:55:24.916511 [debug] [Thread-4  ]: Using postgres connection "model.test_dbt.my_second_dbt_model"
[0m12:55:24.916830 [debug] [Thread-4  ]: On model.test_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_second_dbt_model"} */
alter table "test_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:55:24.918422 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0 seconds
[0m12:55:24.920409 [debug] [Thread-4  ]: On model.test_dbt.my_second_dbt_model: COMMIT
[0m12:55:24.920741 [debug] [Thread-4  ]: Using postgres connection "model.test_dbt.my_second_dbt_model"
[0m12:55:24.920970 [debug] [Thread-4  ]: On model.test_dbt.my_second_dbt_model: COMMIT
[0m12:55:24.932612 [debug] [Thread-4  ]: SQL status: COMMIT in 0 seconds
[0m12:55:24.935803 [debug] [Thread-4  ]: Using postgres connection "model.test_dbt.my_second_dbt_model"
[0m12:55:24.936100 [debug] [Thread-4  ]: On model.test_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_second_dbt_model"} */
drop view if exists "test_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
[0m12:55:24.938618 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0 seconds
[0m12:55:24.940734 [debug] [Thread-4  ]: Timing info for model.test_dbt.my_second_dbt_model (execute): 2023-02-08 12:55:24.850093 => 2023-02-08 12:55:24.940649
[0m12:55:24.941183 [debug] [Thread-4  ]: On model.test_dbt.my_second_dbt_model: Close
[0m12:55:24.942222 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '378cdb66-db03-44fb-82a0-1523bf630edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10969eca0>]}
[0m12:55:24.942732 [info ] [Thread-4  ]: 3 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.10s]
[0m12:55:24.943162 [debug] [Thread-4  ]: Finished running node model.test_dbt.my_second_dbt_model
[0m12:55:25.074427 [debug] [Thread-1  ]: SQL status: SELECT 14610 in 0 seconds
[0m12:55:25.078116 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:55:25.078425 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */
alter table "test_dbt"."public"."dbt_metrics_default_calendar" rename to "dbt_metrics_default_calendar__dbt_backup"
[0m12:55:25.079972 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m12:55:25.083372 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:55:25.083657 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */
alter table "test_dbt"."public"."dbt_metrics_default_calendar__dbt_tmp" rename to "dbt_metrics_default_calendar"
[0m12:55:25.085240 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m12:55:25.087914 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: COMMIT
[0m12:55:25.088225 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:55:25.088434 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: COMMIT
[0m12:55:25.097802 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m12:55:25.102433 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:55:25.102733 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */
drop table if exists "test_dbt"."public"."dbt_metrics_default_calendar__dbt_backup" cascade
[0m12:55:25.124161 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m12:55:25.125674 [debug] [Thread-1  ]: Timing info for model.metrics.dbt_metrics_default_calendar (execute): 2023-02-08 12:55:24.716037 => 2023-02-08 12:55:25.125621
[0m12:55:25.126721 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: Close
[0m12:55:25.151112 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '378cdb66-db03-44fb-82a0-1523bf630edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109803dc0>]}
[0m12:55:25.151652 [info ] [Thread-1  ]: 1 of 4 OK created sql table model public.dbt_metrics_default_calendar .......... [[32mSELECT 14610[0m in 0.54s]
[0m12:55:25.152063 [debug] [Thread-1  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m12:55:25.152816 [debug] [Thread-3  ]: Began running node model.test_dbt.metric_test
[0m12:55:25.153424 [info ] [Thread-3  ]: 4 of 4 START sql view model public.metric_test ................................. [RUN]
[0m12:55:25.154128 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.test_dbt.metric_test'
[0m12:55:25.154493 [debug] [Thread-3  ]: Began compiling node model.test_dbt.metric_test
[0m12:55:25.343028 [debug] [Thread-3  ]: Writing injected SQL for node "model.test_dbt.metric_test"
[0m12:55:25.343702 [debug] [Thread-3  ]: Timing info for model.test_dbt.metric_test (compile): 2023-02-08 12:55:25.154728 => 2023-02-08 12:55:25.343638
[0m12:55:25.344090 [debug] [Thread-3  ]: Began executing node model.test_dbt.metric_test
[0m12:55:25.348937 [debug] [Thread-3  ]: Writing runtime sql for node "model.test_dbt.metric_test"
[0m12:55:25.349482 [debug] [Thread-3  ]: Using postgres connection "model.test_dbt.metric_test"
[0m12:55:25.349674 [debug] [Thread-3  ]: On model.test_dbt.metric_test: BEGIN
[0m12:55:25.349847 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:55:25.369931 [debug] [Thread-3  ]: SQL status: BEGIN in 0 seconds
[0m12:55:25.370228 [debug] [Thread-3  ]: Using postgres connection "model.test_dbt.metric_test"
[0m12:55:25.370448 [debug] [Thread-3  ]: On model.test_dbt.metric_test: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.metric_test"} */

  create view "test_dbt"."public"."metric_test__dbt_tmp" as (
    select *,

    now() + ((interval '1 ') * (1))


from -- depends on: "test_dbt"."public"."dbt_metrics_default_calendar"

(

with calendar as (
    select 
        * 
    from "test_dbt"."public"."dbt_metrics_default_calendar"
     
)

, model_51758de9e889a72967b82e35fea7902f__aggregate as (
    
    select
        date_week,
        name,
        bool_or(metric_date_day is not null) as has_data,
        sum(property_to_aggregate__rolling_new_customers) as rolling_new_customers,
        sum(property_to_aggregate__test_update) as test_update
    from (
        select 
            cast(base_model.date_id as date) as metric_date_day,
            calendar.date_week as date_week,
            calendar.date_day as window_filter_date,
            base_model.name,
            (score) as property_to_aggregate__rolling_new_customers,
            (score) as property_to_aggregate__test_update
        from "test_dbt"."public"."my_first_dbt_model" base_model 
        
        left join calendar
            on cast(base_model.date_id as date) = calendar.date_day
        
        where 1=1
        
    ) as base_query

    where 1=1
    group by 1, 2

), model_51758de9e889a72967b82e35fea7902f__final as (
    
    select
        parent_metric_cte.date_week,
        parent_metric_cte.name,
        coalesce(rolling_new_customers, 0) as rolling_new_customers,
        coalesce(test_update, 0) as test_update
    from model_51758de9e889a72967b82e35fea7902f__aggregate as parent_metric_cte
)

select
    date_week ,
    name,
    rolling_new_customers,
    test_update  
    
from model_51758de9e889a72967b82e35fea7902f__final
    
order by 1 desc
    
) metric_subq
  );
[0m12:55:25.390245 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0 seconds
[0m12:55:25.393538 [debug] [Thread-3  ]: Using postgres connection "model.test_dbt.metric_test"
[0m12:55:25.393835 [debug] [Thread-3  ]: On model.test_dbt.metric_test: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.metric_test"} */
alter table "test_dbt"."public"."metric_test__dbt_tmp" rename to "metric_test"
[0m12:55:25.395662 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0 seconds
[0m12:55:25.397407 [debug] [Thread-3  ]: On model.test_dbt.metric_test: COMMIT
[0m12:55:25.397612 [debug] [Thread-3  ]: Using postgres connection "model.test_dbt.metric_test"
[0m12:55:25.397794 [debug] [Thread-3  ]: On model.test_dbt.metric_test: COMMIT
[0m12:55:25.401398 [debug] [Thread-3  ]: SQL status: COMMIT in 0 seconds
[0m12:55:25.403935 [debug] [Thread-3  ]: Using postgres connection "model.test_dbt.metric_test"
[0m12:55:25.404145 [debug] [Thread-3  ]: On model.test_dbt.metric_test: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.metric_test"} */
drop view if exists "test_dbt"."public"."metric_test__dbt_backup" cascade
[0m12:55:25.405590 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0 seconds
[0m12:55:25.406831 [debug] [Thread-3  ]: Timing info for model.test_dbt.metric_test (execute): 2023-02-08 12:55:25.344244 => 2023-02-08 12:55:25.406785
[0m12:55:25.407052 [debug] [Thread-3  ]: On model.test_dbt.metric_test: Close
[0m12:55:25.407703 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '378cdb66-db03-44fb-82a0-1523bf630edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098030a0>]}
[0m12:55:25.408135 [info ] [Thread-3  ]: 4 of 4 OK created sql view model public.metric_test ............................ [[32mCREATE VIEW[0m in 0.25s]
[0m12:55:25.408481 [debug] [Thread-3  ]: Finished running node model.test_dbt.metric_test
[0m12:55:25.409827 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:55:25.410152 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:25.410456 [debug] [MainThread]: On master: BEGIN
[0m12:55:25.410691 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:55:25.431643 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:55:25.432032 [debug] [MainThread]: On master: COMMIT
[0m12:55:25.432282 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:25.432510 [debug] [MainThread]: On master: COMMIT
[0m12:55:25.434323 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:55:25.434676 [debug] [MainThread]: On master: Close
[0m12:55:25.435242 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:55:25.435461 [debug] [MainThread]: Connection 'model.metrics.dbt_metrics_default_calendar' was properly closed.
[0m12:55:25.435648 [debug] [MainThread]: Connection 'model.test_dbt.my_first_dbt_model' was properly closed.
[0m12:55:25.435827 [debug] [MainThread]: Connection 'model.test_dbt.my_second_dbt_model' was properly closed.
[0m12:55:25.436003 [debug] [MainThread]: Connection 'model.test_dbt.metric_test' was properly closed.
[0m12:55:25.436279 [info ] [MainThread]: 
[0m12:55:25.436568 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m12:55:25.437054 [debug] [MainThread]: Command end result
[0m12:55:25.447618 [info ] [MainThread]: 
[0m12:55:25.448038 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:55:25.448329 [info ] [MainThread]: 
[0m12:55:25.448611 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:55:25.448963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fef6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109648b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109648be0>]}
[0m12:55:25.449264 [debug] [MainThread]: Flushing usage events


============================== 2023-02-12 13:38:39.891354 | 6b8fa451-19b6-4365-bf0b-0401bd4e9a43 ==============================
[0m13:38:39.891354 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:38:39.894438 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/afinkelstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m13:38:39.894699 [debug] [MainThread]: Tracking: tracking
[0m13:38:39.917397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10623dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108122760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108122130>]}
[0m13:38:40.124545 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:38:40.125110 [debug] [MainThread]: Partial parsing: updated file: test_dbt://models/example/metrics.yml
[0m13:38:40.138375 [debug] [MainThread]: 1603: static parser failed on example/metric_test.sql
[0m13:38:40.194071 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/metric_test.sql
[0m13:38:40.222427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b8fa451-19b6-4365-bf0b-0401bd4e9a43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c6e80>]}
[0m13:38:40.233067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b8fa451-19b6-4365-bf0b-0401bd4e9a43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108113df0>]}
[0m13:38:40.233408 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 515 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 3 metrics
[0m13:38:40.233666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b8fa451-19b6-4365-bf0b-0401bd4e9a43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108118070>]}
[0m13:38:40.235060 [info ] [MainThread]: 
[0m13:38:40.236619 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:38:40.237447 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_dbt_public'
[0m13:38:40.247449 [debug] [ThreadPool]: Using postgres connection "list_test_dbt_public"
[0m13:38:40.247673 [debug] [ThreadPool]: On list_test_dbt_public: BEGIN
[0m13:38:40.247869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:40.427975 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:38:40.428283 [debug] [ThreadPool]: Using postgres connection "list_test_dbt_public"
[0m13:38:40.428491 [debug] [ThreadPool]: On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "list_test_dbt_public"} */
select
      'test_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:38:40.549122 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m13:38:40.550722 [debug] [ThreadPool]: On list_test_dbt_public: ROLLBACK
[0m13:38:40.551799 [debug] [ThreadPool]: On list_test_dbt_public: Close
[0m13:38:40.558210 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:40.558547 [debug] [MainThread]: On master: BEGIN
[0m13:38:40.558816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:38:40.592312 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:38:40.592619 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:40.592834 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:38:40.660634 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m13:38:40.662134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b8fa451-19b6-4365-bf0b-0401bd4e9a43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108511e80>]}
[0m13:38:40.662493 [debug] [MainThread]: On master: ROLLBACK
[0m13:38:40.664261 [debug] [MainThread]: On master: Close
[0m13:38:40.665021 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m13:38:40.665351 [info ] [MainThread]: 
[0m13:38:40.670495 [debug] [Thread-1  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m13:38:40.670928 [debug] [Thread-2  ]: Began running node model.test_dbt.my_first_dbt_model
[0m13:38:40.671904 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.metrics.dbt_metrics_default_calendar'
[0m13:38:40.672541 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.test_dbt.my_first_dbt_model'
[0m13:38:40.672818 [debug] [Thread-1  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m13:38:40.673079 [debug] [Thread-2  ]: Began compiling node model.test_dbt.my_first_dbt_model
[0m13:38:40.704636 [debug] [Thread-2  ]: Writing injected SQL for node "model.test_dbt.my_first_dbt_model"
[0m13:38:40.707532 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m13:38:40.707905 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: BEGIN
[0m13:38:40.708169 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:38:40.708408 [debug] [Thread-2  ]: Timing info for model.test_dbt.my_first_dbt_model (compile): 2023-02-12 13:38:40.699545 => 2023-02-12 13:38:40.708328
[0m13:38:40.708908 [debug] [Thread-2  ]: Began executing node model.test_dbt.my_first_dbt_model
[0m13:38:40.709241 [debug] [Thread-2  ]: Timing info for model.test_dbt.my_first_dbt_model (execute): 2023-02-12 13:38:40.709169 => 2023-02-12 13:38:40.709192
[0m13:38:40.711219 [debug] [Thread-2  ]: Finished running node model.test_dbt.my_first_dbt_model
[0m13:38:40.711975 [debug] [Thread-4  ]: Began running node model.test_dbt.my_second_dbt_model
[0m13:38:40.712268 [debug] [Thread-5  ]: Began running node test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:38:40.712515 [debug] [Thread-3  ]: Began running node test.test_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:38:40.713102 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.test_dbt.my_second_dbt_model'
[0m13:38:40.713774 [debug] [Thread-5  ]: Acquiring new postgres connection 'test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710'
[0m13:38:40.714414 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.test_dbt.unique_my_first_dbt_model_id.16e066b321'
[0m13:38:40.714708 [debug] [Thread-4  ]: Began compiling node model.test_dbt.my_second_dbt_model
[0m13:38:40.714967 [debug] [Thread-5  ]: Began compiling node test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:38:40.715282 [debug] [Thread-3  ]: Began compiling node test.test_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:38:40.718998 [debug] [Thread-4  ]: Writing injected SQL for node "model.test_dbt.my_second_dbt_model"
[0m13:38:40.736249 [debug] [Thread-5  ]: Writing injected SQL for node "test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:38:40.736543 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m13:38:40.744257 [debug] [Thread-3  ]: Writing injected SQL for node "test.test_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m13:38:40.744773 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m13:38:40.745091 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 
        ((cast('2030-01-01' as date))::date - (cast('1990-01-01' as date))::date)
    
[0m13:38:40.745588 [debug] [Thread-5  ]: Timing info for test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 2023-02-12 13:38:40.719386 => 2023-02-12 13:38:40.745524
[0m13:38:40.745801 [debug] [Thread-3  ]: Timing info for test.test_dbt.unique_my_first_dbt_model_id.16e066b321 (compile): 2023-02-12 13:38:40.736712 => 2023-02-12 13:38:40.745757
[0m13:38:40.745986 [debug] [Thread-4  ]: Timing info for model.test_dbt.my_second_dbt_model (compile): 2023-02-12 13:38:40.715525 => 2023-02-12 13:38:40.745933
[0m13:38:40.746236 [debug] [Thread-5  ]: Began executing node test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:38:40.746509 [debug] [Thread-3  ]: Began executing node test.test_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:38:40.746785 [debug] [Thread-4  ]: Began executing node model.test_dbt.my_second_dbt_model
[0m13:38:40.747057 [debug] [Thread-5  ]: Timing info for test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 2023-02-12 13:38:40.746996 => 2023-02-12 13:38:40.747009
[0m13:38:40.747322 [debug] [Thread-3  ]: Timing info for test.test_dbt.unique_my_first_dbt_model_id.16e066b321 (execute): 2023-02-12 13:38:40.747266 => 2023-02-12 13:38:40.747275
[0m13:38:40.747602 [debug] [Thread-4  ]: Timing info for model.test_dbt.my_second_dbt_model (execute): 2023-02-12 13:38:40.747546 => 2023-02-12 13:38:40.747555
[0m13:38:40.748281 [debug] [Thread-5  ]: Finished running node test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:38:40.748908 [debug] [Thread-3  ]: Finished running node test.test_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:38:40.749579 [debug] [Thread-4  ]: Finished running node model.test_dbt.my_second_dbt_model
[0m13:38:40.750503 [debug] [Thread-2  ]: Began running node test.test_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:38:40.750764 [debug] [Thread-5  ]: Began running node test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:38:40.751294 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.test_dbt.not_null_my_second_dbt_model_id.151b76d778'
[0m13:38:40.751846 [debug] [Thread-5  ]: Acquiring new postgres connection 'test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493'
[0m13:38:40.752135 [debug] [Thread-2  ]: Began compiling node test.test_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:38:40.752435 [debug] [Thread-5  ]: Began compiling node test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:38:40.757283 [debug] [Thread-2  ]: Writing injected SQL for node "test.test_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m13:38:40.757509 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m13:38:40.761640 [debug] [Thread-5  ]: Writing injected SQL for node "test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:38:40.775396 [debug] [Thread-1  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m13:38:40.775672 [debug] [Thread-2  ]: Timing info for test.test_dbt.not_null_my_second_dbt_model_id.151b76d778 (compile): 2023-02-12 13:38:40.752688 => 2023-02-12 13:38:40.775611
[0m13:38:40.776258 [debug] [Thread-2  ]: Began executing node test.test_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:38:40.776481 [debug] [Thread-2  ]: Timing info for test.test_dbt.not_null_my_second_dbt_model_id.151b76d778 (execute): 2023-02-12 13:38:40.776433 => 2023-02-12 13:38:40.776443
[0m13:38:40.777069 [debug] [Thread-2  ]: Finished running node test.test_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:38:40.777515 [debug] [Thread-5  ]: Timing info for test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493 (compile): 2023-02-12 13:38:40.757726 => 2023-02-12 13:38:40.777458
[0m13:38:40.778090 [debug] [Thread-5  ]: Began executing node test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:38:40.778379 [debug] [Thread-1  ]: Timing info for model.metrics.dbt_metrics_default_calendar (compile): 2023-02-12 13:38:40.673278 => 2023-02-12 13:38:40.778333
[0m13:38:40.778582 [debug] [Thread-5  ]: Timing info for test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493 (execute): 2023-02-12 13:38:40.778539 => 2023-02-12 13:38:40.778546
[0m13:38:40.778803 [debug] [Thread-1  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m13:38:40.779324 [debug] [Thread-5  ]: Finished running node test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:38:40.779532 [debug] [Thread-1  ]: Timing info for model.metrics.dbt_metrics_default_calendar (execute): 2023-02-12 13:38:40.779491 => 2023-02-12 13:38:40.779496
[0m13:38:40.779870 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: ROLLBACK
[0m13:38:40.781899 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: Close
[0m13:38:40.782674 [debug] [Thread-1  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m13:38:40.783450 [debug] [Thread-4  ]: Began running node model.test_dbt.metric_test
[0m13:38:40.784080 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.test_dbt.metric_test'
[0m13:38:40.784297 [debug] [Thread-4  ]: Began compiling node model.test_dbt.metric_test
[0m13:38:40.957641 [debug] [Thread-4  ]: Writing injected SQL for node "model.test_dbt.metric_test"
[0m13:38:40.958995 [debug] [Thread-4  ]: Timing info for model.test_dbt.metric_test (compile): 2023-02-12 13:38:40.784450 => 2023-02-12 13:38:40.958932
[0m13:38:40.959229 [debug] [Thread-4  ]: Began executing node model.test_dbt.metric_test
[0m13:38:40.959424 [debug] [Thread-4  ]: Timing info for model.test_dbt.metric_test (execute): 2023-02-12 13:38:40.959379 => 2023-02-12 13:38:40.959389
[0m13:38:40.960144 [debug] [Thread-4  ]: Finished running node model.test_dbt.metric_test
[0m13:38:40.961843 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:40.962030 [debug] [MainThread]: Connection 'model.metrics.dbt_metrics_default_calendar' was properly closed.
[0m13:38:40.962185 [debug] [MainThread]: Connection 'test.test_dbt.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m13:38:40.962419 [debug] [MainThread]: Connection 'model.test_dbt.metric_test' was properly closed.
[0m13:38:40.962566 [debug] [MainThread]: Connection 'test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m13:38:40.962711 [debug] [MainThread]: Connection 'test.test_dbt.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m13:38:40.963351 [debug] [MainThread]: Command end result
[0m13:38:40.974495 [info ] [MainThread]: Done.
[0m13:38:40.978697 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m13:38:40.978903 [info ] [MainThread]: Building catalog
[0m13:38:40.980276 [debug] [ThreadPool]: Acquiring new postgres connection 'test_dbt.information_schema'
[0m13:38:40.987014 [debug] [ThreadPool]: Using postgres connection "test_dbt.information_schema"
[0m13:38:40.987255 [debug] [ThreadPool]: On test_dbt.information_schema: BEGIN
[0m13:38:40.987477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:41.000975 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:38:41.001331 [debug] [ThreadPool]: Using postgres connection "test_dbt.information_schema"
[0m13:38:41.001568 [debug] [ThreadPool]: On test_dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "test_dbt.information_schema"} */

    
    

    select
        'test_dbt' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m13:38:41.064243 [debug] [ThreadPool]: SQL status: SELECT 18 in 0 seconds
[0m13:38:41.070848 [debug] [ThreadPool]: On test_dbt.information_schema: ROLLBACK
[0m13:38:41.072358 [debug] [ThreadPool]: On test_dbt.information_schema: Close
[0m13:38:41.085623 [info ] [MainThread]: Catalog written to /Users/afinkelstein/work/test_dbt/target/catalog.json
[0m13:38:41.086223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10623dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f06d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f05b0>]}
[0m13:38:41.086527 [debug] [MainThread]: Flushing usage events
[0m13:38:41.944993 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:38:41.945506 [debug] [MainThread]: Connection 'test_dbt.information_schema' was properly closed.


============================== 2023-02-12 13:38:50.901241 | 67e1a652-d4ed-470b-a039-c3365bc77c0e ==============================
[0m13:38:50.901241 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:38:50.903586 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/afinkelstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m13:38:50.903869 [debug] [MainThread]: Tracking: tracking
[0m13:38:50.922261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3f3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3fd130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3fd040>]}
[0m13:38:50.925055 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m13:38:50.925400 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m13:38:50.925668 [info ] [MainThread]: 
[0m13:38:50.925926 [info ] [MainThread]: 
[0m13:38:50.926170 [info ] [MainThread]: Press Ctrl+C to exit.
[0m15:23:48.753961 [debug] [MainThread]: Flushing usage events
[0m15:23:48.942850 [info ] [MainThread]: ctrl-c


============================== 2023-02-12 15:26:14.263555 | b895f198-f5b5-4696-a750-bf5b42ba8073 ==============================
[0m15:26:14.263555 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:26:14.266962 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/afinkelstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m15:26:14.267316 [debug] [MainThread]: Tracking: tracking
[0m15:26:14.286671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c95cca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c951d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c951160>]}
[0m15:26:14.484428 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:26:14.485282 [debug] [MainThread]: Partial parsing: updated file: test_dbt://models/example/metrics.yml
[0m15:26:14.493179 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

dbt-core v1.3 renamed attributes for metrics:
  'sql'              -> 'expression'
  'type'             -> 'calculation_method'
  'type: expression' -> 'calculation_method: derived'
Please remove them from the metric definition of metric 'test_window_metric'
Relevant issue here: https://github.com/dbt-labs/dbt-core/issues/5849
[0m15:26:14.493558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b895f198-f5b5-4696-a750-bf5b42ba8073', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ceba2b0>]}
[0m15:26:14.496222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdbd4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ceace80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ceb38e0>]}
[0m15:26:14.496462 [debug] [MainThread]: Flushing usage events
[0m15:26:16.009143 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid metrics config given in FilePath(searched_path='models', relative_path='example/metrics.yml', modification_time=1675597666.0024235, project_root='/Users/afinkelstein/work/test_dbt') @ metrics: {'name': 'test_window_metric', 'description': 'Rolling average of order amounts over a 7-day period', 'value': 'score', 'rolling_window': {'size': 7, 'offset': '1 day', 'field': 'date_id', 'timeframes': ['7 days']}, 'expression': "select\n  date_id,\n  avg(score) over (\n    order by order_date\n    rows between 6 preceding and current row\n  ) as rolling_average\nfrom {{ ref('my_first_dbt_model') }}", 'calculation_method': 'sum'} - at path []: 'label' is a required property


============================== 2023-02-12 15:27:09.644512 | f2e3eb84-0022-4f14-9826-3e2575317d21 ==============================
[0m15:27:09.644512 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:27:09.646678 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/afinkelstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m15:27:09.647073 [debug] [MainThread]: Tracking: tracking
[0m15:27:09.667840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0fcca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0f1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0f1040>]}
[0m15:27:09.835555 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:27:09.836047 [debug] [MainThread]: Partial parsing: updated file: test_dbt://models/example/metrics.yml
[0m15:27:09.843788 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

dbt-core v1.3 renamed attributes for metrics:
  'sql'              -> 'expression'
  'type'             -> 'calculation_method'
  'type: expression' -> 'calculation_method: derived'
Please remove them from the metric definition of metric 'test_window_metric'
Relevant issue here: https://github.com/dbt-labs/dbt-core/issues/5849
[0m15:27:09.844070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f2e3eb84-0022-4f14-9826-3e2575317d21', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e653040>]}
[0m15:27:09.846753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e55d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e64cf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6534f0>]}
[0m15:27:09.846999 [debug] [MainThread]: Flushing usage events
[0m15:27:11.037999 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid metrics config given in FilePath(searched_path='models', relative_path='example/metrics.yml', modification_time=1675597666.0024235, project_root='/Users/afinkelstein/work/test_dbt') @ metrics: {'name': 'test_window_metric', 'description': 'Rolling average of order amounts over a 7-day period', 'value': 'score', 'rolling_window': {'size': 7, 'offset': '1 day', 'field': 'date_id', 'timeframes': ['7 days']}, 'label': 'test_label', 'expression': "select\n  date_id,\n  avg(score) over (\n    order by order_date\n    rows between 6 preceding and current row\n  ) as rolling_average\nfrom {{ ref('my_first_dbt_model') }}", 'calculation_method': 'sum'} - at path []: Additional properties are not allowed ('rolling_window', 'value' were unexpected)


============================== 2023-02-21 12:13:22.896575 | 83860d7c-c85a-45d7-bdfe-07b9a47520fd ==============================
[0m12:13:22.896575 [info ] [MainThread]: Running with dbt=1.4.1
[0m12:13:22.897735 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rom.weinstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'skip_profile_setup': False, 'which': 'init', 'indirect_selection': 'eager'}
[0m12:13:22.897866 [debug] [MainThread]: Tracking: tracking
[0m12:13:22.914929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1221510d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12215d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12215deb0>]}
[0m12:13:22.915656 [info ] [MainThread]: Setting up your profile.
[0m12:13:26.781426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1208cb670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120141c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122151610>]}
[0m12:13:26.781742 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 12:15:38.142167 | 0225d2af-ae4a-44d8-9f11-642171b3b38d ==============================
[0m12:15:38.142167 [info ] [MainThread]: Running with dbt=1.4.1
[0m12:15:38.142819 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rom.weinstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'skip_profile_setup': False, 'which': 'init', 'indirect_selection': 'eager'}
[0m12:15:38.142914 [debug] [MainThread]: Tracking: tracking
[0m12:15:38.162636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f9ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f9c130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f9c0d0>]}
[0m12:15:38.163339 [info ] [MainThread]: Setting up your profile.
[0m12:15:43.759109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121a05b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f8370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107450670>]}
[0m12:15:43.759348 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 12:16:59.343277 | 0431be3d-a4cb-4375-902a-1cad8172f6d8 ==============================
[0m12:16:59.343277 [info ] [MainThread]: Running with dbt=1.4.1
[0m12:16:59.343924 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rom.weinstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'skip_profile_setup': False, 'which': 'init', 'indirect_selection': 'eager'}
[0m12:16:59.344014 [debug] [MainThread]: Tracking: tracking
[0m12:16:59.363251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10795dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10795d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10795d400>]}
[0m12:16:59.364166 [info ] [MainThread]: Setting up your profile.
[0m12:17:03.502980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b5c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b61730>]}
[0m12:17:03.503266 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 12:23:37.814146 | fb6b8e0b-1a85-449b-8bb9-f57ae19b1e57 ==============================
[0m12:23:37.814146 [info ] [MainThread]: Running with dbt=1.4.1
[0m12:23:37.815512 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rom.weinstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:23:37.815640 [debug] [MainThread]: Tracking: tracking
[0m12:23:37.831050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110222250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110291ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110291a00>]}
[0m12:23:37.832042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110222250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110291ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110291a00>]}
[0m12:23:37.832203 [debug] [MainThread]: Flushing usage events
[0m12:23:38.475137 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 2 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.


============================== 2023-02-21 12:23:46.803066 | a556c645-e736-412e-88b1-ad5614496177 ==============================
[0m12:23:46.803066 [info ] [MainThread]: Running with dbt=1.4.1
[0m12:23:46.803786 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rom.weinstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m12:23:46.803890 [debug] [MainThread]: Tracking: tracking
[0m12:23:46.822116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11173f280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111750df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111750e20>]}
[0m12:23:46.824144 [debug] [MainThread]: Set downloads directory='/var/folders/p0/bjgxzb6x1px3g0w39nrqfklw0000gp/T/dbt-downloads-_2kbkvd5'
[0m12:23:46.824724 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:23:47.392087 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:23:47.393046 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/metrics.json
[0m12:23:47.873245 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/metrics.json 200
[0m12:23:47.884778 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:23:48.375619 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:23:48.415953 [info ] [MainThread]: Installing dbt-labs/metrics
[0m12:23:49.542599 [info ] [MainThread]:   Installed from version 1.4.0
[0m12:23:49.542841 [info ] [MainThread]:   Up to date!
[0m12:23:49.543056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a556c645-e736-412e-88b1-ad5614496177', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117e7640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117e76d0>]}
[0m12:23:49.543231 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:23:50.385397 [info ] [MainThread]:   Installed from version 1.0.0
[0m12:23:50.385638 [info ] [MainThread]:   Up to date!
[0m12:23:50.385823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a556c645-e736-412e-88b1-ad5614496177', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117e76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112214d30>]}
[0m12:23:50.386636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111698d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11173fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117e76d0>]}
[0m12:23:50.386809 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 12:23:55.462153 | 0d1b8062-40f4-4095-842e-7dbd883415fc ==============================
[0m12:23:55.462153 [info ] [MainThread]: Running with dbt=1.4.1
[0m12:23:55.463355 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rom.weinstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:23:55.463479 [debug] [MainThread]: Tracking: tracking
[0m12:23:55.481897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10699a040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106971b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cfce80>]}
[0m12:23:55.500095 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:23:55.500332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0d1b8062-40f4-4095-842e-7dbd883415fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d15310>]}
[0m12:23:56.145760 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m12:23:56.151900 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m12:23:56.153332 [debug] [MainThread]: 1603: static parser failed on example/metric_test.sql
[0m12:23:56.177580 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/metric_test.sql
[0m12:23:56.188525 [debug] [MainThread]: 1603: static parser failed on dbt_metrics_default_calendar.sql
[0m12:23:56.203816 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dbt_metrics_default_calendar.sql
[0m12:23:56.247494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d1b8062-40f4-4095-842e-7dbd883415fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f30d0>]}
[0m12:23:56.252770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d1b8062-40f4-4095-842e-7dbd883415fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069847f0>]}
[0m12:23:56.252963 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 515 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 3 metrics
[0m12:23:56.253098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d1b8062-40f4-4095-842e-7dbd883415fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070809d0>]}
[0m12:23:56.253761 [info ] [MainThread]: 
[0m12:23:56.254554 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:23:56.255274 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_dbt'
[0m12:23:56.258630 [debug] [ThreadPool]: Using postgres connection "list_test_dbt"
[0m12:23:56.258774 [debug] [ThreadPool]: On list_test_dbt: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "list_test_dbt"} */

    select distinct nspname from pg_namespace
  
[0m12:23:56.258880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:56.319169 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "test_dbt" does not exist

[0m12:23:56.327217 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "list_test_dbt"} */

    select distinct nspname from pg_namespace
  
[0m12:23:56.327407 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m12:23:56.327574 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m12:23:56.327695 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m12:23:56.327833 [debug] [ThreadPool]: On list_test_dbt: No close available on handle
[0m12:23:56.328485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:23:56.328607 [debug] [MainThread]: Connection 'list_test_dbt' was properly closed.
[0m12:23:56.328730 [info ] [MainThread]: 
[0m12:23:56.328891 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m12:23:56.329071 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "test_dbt" does not exist
  
[0m12:23:56.329274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107055670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10721b8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10721bbb0>]}
[0m12:23:56.329448 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 12:24:53.052152 | efe9814b-26e5-41e9-9337-bef9301c9485 ==============================
[0m12:24:53.052152 [info ] [MainThread]: Running with dbt=1.4.1
[0m12:24:53.053471 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rom.weinstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:24:53.053585 [debug] [MainThread]: Tracking: tracking
[0m12:24:53.072898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113821250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113891ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113891a00>]}
[0m12:24:53.169436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:24:53.169654 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:24:53.174389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efe9814b-26e5-41e9-9337-bef9301c9485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e880d0>]}
[0m12:24:53.180251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efe9814b-26e5-41e9-9337-bef9301c9485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c4ea60>]}
[0m12:24:53.180437 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 515 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 3 metrics
[0m12:24:53.180576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efe9814b-26e5-41e9-9337-bef9301c9485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113821250>]}
[0m12:24:53.181273 [info ] [MainThread]: 
[0m12:24:53.182086 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:24:53.182629 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_dbt'
[0m12:24:53.188144 [debug] [ThreadPool]: Using postgres connection "list_test_dbt"
[0m12:24:53.188277 [debug] [ThreadPool]: On list_test_dbt: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "list_test_dbt"} */

    select distinct nspname from pg_namespace
  
[0m12:24:53.188377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:53.253405 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m12:24:53.254464 [debug] [ThreadPool]: On list_test_dbt: Close
[0m12:24:53.255463 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_dbt_public'
[0m12:24:53.259648 [debug] [ThreadPool]: Using postgres connection "list_test_dbt_public"
[0m12:24:53.259811 [debug] [ThreadPool]: On list_test_dbt_public: BEGIN
[0m12:24:53.259928 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:24:53.292123 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m12:24:53.292410 [debug] [ThreadPool]: Using postgres connection "list_test_dbt_public"
[0m12:24:53.292548 [debug] [ThreadPool]: On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "list_test_dbt_public"} */
select
      'test_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m12:24:53.298836 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m12:24:53.299749 [debug] [ThreadPool]: On list_test_dbt_public: ROLLBACK
[0m12:24:53.300076 [debug] [ThreadPool]: On list_test_dbt_public: Close
[0m12:24:53.303682 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:53.303866 [debug] [MainThread]: On master: BEGIN
[0m12:24:53.303997 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:24:53.310406 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:24:53.310542 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:53.310656 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:24:53.313615 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m12:24:53.314322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efe9814b-26e5-41e9-9337-bef9301c9485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113876280>]}
[0m12:24:53.314541 [debug] [MainThread]: On master: ROLLBACK
[0m12:24:53.314796 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:53.314921 [debug] [MainThread]: On master: BEGIN
[0m12:24:53.315247 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:24:53.315371 [debug] [MainThread]: On master: COMMIT
[0m12:24:53.315485 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:53.315593 [debug] [MainThread]: On master: COMMIT
[0m12:24:53.315799 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:24:53.315924 [debug] [MainThread]: On master: Close
[0m12:24:53.316259 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:24:53.316418 [info ] [MainThread]: 
[0m12:24:53.319084 [debug] [Thread-1  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m12:24:53.319329 [info ] [Thread-1  ]: 1 of 4 START sql table model public.dbt_metrics_default_calendar ............... [RUN]
[0m12:24:53.319782 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.metrics.dbt_metrics_default_calendar'
[0m12:24:53.319935 [debug] [Thread-1  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m12:24:53.334527 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:24:53.334730 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: BEGIN
[0m12:24:53.334841 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:24:53.345390 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m12:24:53.345606 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:24:53.345710 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 
        ((cast('2030-01-01' as date))::date - (cast('1990-01-01' as date))::date)
    
[0m12:24:53.346796 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m12:24:53.356439 [debug] [Thread-1  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m12:24:53.357243 [debug] [Thread-1  ]: Timing info for model.metrics.dbt_metrics_default_calendar (compile): 2023-02-21 12:24:53.320031 => 2023-02-21 12:24:53.357199
[0m12:24:53.357394 [debug] [Thread-1  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m12:24:53.377790 [debug] [Thread-1  ]: Writing runtime sql for node "model.metrics.dbt_metrics_default_calendar"
[0m12:24:53.378542 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:24:53.378656 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */

  
    

  create  table "test_dbt"."public"."dbt_metrics_default_calendar__dbt_tmp"
  as (
    

with days as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
    
    

    )

    select *
    from unioned
    where generated_number <= 14610
    order by generated_number



),

all_periods as (

    select (
        

    cast('1990-01-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2030-01-01' as date)

)

select * from filtered


),

final as (
    select 
        cast(date_day as date) as date_day,
        cast(date_trunc('week', date_day) as date) as date_week,
        cast(date_trunc('month', date_day) as date) as date_month,
        cast(date_trunc('quarter', date_day) as date) as date_quarter,
        cast(date_trunc('year', date_day) as date) as date_year
    from days
)

select * from final
  );
  
[0m12:24:53.435920 [debug] [Thread-1  ]: SQL status: SELECT 14610 in 0 seconds
[0m12:24:53.441680 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:24:53.441863 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */
alter table "test_dbt"."public"."dbt_metrics_default_calendar__dbt_tmp" rename to "dbt_metrics_default_calendar"
[0m12:24:53.442448 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m12:24:53.453980 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: COMMIT
[0m12:24:53.454151 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:24:53.454249 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: COMMIT
[0m12:24:53.455240 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m12:24:53.458285 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:24:53.458430 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */
drop table if exists "test_dbt"."public"."dbt_metrics_default_calendar__dbt_backup" cascade
[0m12:24:53.458750 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m12:24:53.459404 [debug] [Thread-1  ]: Timing info for model.metrics.dbt_metrics_default_calendar (execute): 2023-02-21 12:24:53.357493 => 2023-02-21 12:24:53.459374
[0m12:24:53.459542 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: Close
[0m12:24:53.459896 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efe9814b-26e5-41e9-9337-bef9301c9485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fac580>]}
[0m12:24:53.460124 [info ] [Thread-1  ]: 1 of 4 OK created sql table model public.dbt_metrics_default_calendar .......... [[32mSELECT 14610[0m in 0.14s]
[0m12:24:53.460869 [debug] [Thread-1  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m12:24:53.461038 [debug] [Thread-1  ]: Began running node model.test_dbt.my_first_dbt_model
[0m12:24:53.461241 [info ] [Thread-1  ]: 2 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m12:24:53.461592 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.test_dbt.my_first_dbt_model'
[0m12:24:53.461722 [debug] [Thread-1  ]: Began compiling node model.test_dbt.my_first_dbt_model
[0m12:24:53.463422 [debug] [Thread-1  ]: Writing injected SQL for node "model.test_dbt.my_first_dbt_model"
[0m12:24:53.464129 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_first_dbt_model (compile): 2023-02-21 12:24:53.461803 => 2023-02-21 12:24:53.464103
[0m12:24:53.464246 [debug] [Thread-1  ]: Began executing node model.test_dbt.my_first_dbt_model
[0m12:24:53.466667 [debug] [Thread-1  ]: Writing runtime sql for node "model.test_dbt.my_first_dbt_model"
[0m12:24:53.467243 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:24:53.467340 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: BEGIN
[0m12:24:53.467429 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:24:53.471161 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m12:24:53.471311 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:24:53.471399 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_first_dbt_model"} */

  
    

  create  table "test_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id,'alexey' as name, '1991-01-01' as date_id, 97 score
    union all
    select 1 as id,'alexey' as name, '1991-01-02' as date_id, 66 score
    union all
    select 2 as id,'sergey' as name, '1991-01-03' as date_id, 50 score

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m12:24:53.474024 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m12:24:53.475871 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:24:53.475981 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_first_dbt_model"} */
alter table "test_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:24:53.476367 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m12:24:53.477393 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: COMMIT
[0m12:24:53.477500 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:24:53.477588 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: COMMIT
[0m12:24:53.478279 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m12:24:53.480254 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:24:53.480367 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_first_dbt_model"} */
drop table if exists "test_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
[0m12:24:53.480671 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m12:24:53.481265 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_first_dbt_model (execute): 2023-02-21 12:24:53.464321 => 2023-02-21 12:24:53.481229
[0m12:24:53.481391 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: Close
[0m12:24:53.481721 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efe9814b-26e5-41e9-9337-bef9301c9485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fac3a0>]}
[0m12:24:53.481934 [info ] [Thread-1  ]: 2 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 3[0m in 0.02s]
[0m12:24:53.482107 [debug] [Thread-1  ]: Finished running node model.test_dbt.my_first_dbt_model
[0m12:24:53.482465 [debug] [Thread-1  ]: Began running node model.test_dbt.metric_test
[0m12:24:53.482612 [info ] [Thread-1  ]: 3 of 4 START sql view model public.metric_test ................................. [RUN]
[0m12:24:53.482896 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.test_dbt.metric_test'
[0m12:24:53.483005 [debug] [Thread-1  ]: Began compiling node model.test_dbt.metric_test
[0m12:24:53.595807 [debug] [Thread-1  ]: Writing injected SQL for node "model.test_dbt.metric_test"
[0m12:24:53.596404 [debug] [Thread-1  ]: Timing info for model.test_dbt.metric_test (compile): 2023-02-21 12:24:53.483078 => 2023-02-21 12:24:53.596356
[0m12:24:53.596556 [debug] [Thread-1  ]: Began executing node model.test_dbt.metric_test
[0m12:24:53.605748 [debug] [Thread-1  ]: Writing runtime sql for node "model.test_dbt.metric_test"
[0m12:24:53.606178 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.metric_test"
[0m12:24:53.606275 [debug] [Thread-1  ]: On model.test_dbt.metric_test: BEGIN
[0m12:24:53.606358 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:24:53.621873 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m12:24:53.622017 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.metric_test"
[0m12:24:53.622100 [debug] [Thread-1  ]: On model.test_dbt.metric_test: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.metric_test"} */

  create view "test_dbt"."public"."metric_test__dbt_tmp" as (
    select *,

    now() + ((interval '1 ') * (1))


from -- depends on: "test_dbt"."public"."dbt_metrics_default_calendar"

(

with calendar as (
    select 
        * 
    from "test_dbt"."public"."dbt_metrics_default_calendar"
     
)

, model_51758de9e889a72967b82e35fea7902f__aggregate as (
    
    select
        date_week,
        name,
        bool_or(metric_date_day is not null) as has_data,
        sum(property_to_aggregate__rolling_new_customers) as rolling_new_customers,
        max(property_to_aggregate__test_update) as test_update
    from (
        select 
            cast(base_model.date_id as date) as metric_date_day,
            calendar.date_week as date_week,
            calendar.date_day as window_filter_date,
            base_model.name,
            (score) as property_to_aggregate__rolling_new_customers,
            (score) as property_to_aggregate__test_update
        from "test_dbt"."public"."my_first_dbt_model" base_model 
        
        left join calendar
            on cast(base_model.date_id as date) = calendar.date_day
        
        where 1=1
        
    ) as base_query

    where 1=1
    group by 1, 2

), model_51758de9e889a72967b82e35fea7902f__final as (
    
    select
        parent_metric_cte.date_week,
        parent_metric_cte.name,
        coalesce(rolling_new_customers, 0) as rolling_new_customers,
        coalesce(test_update, 0) as test_update
    from model_51758de9e889a72967b82e35fea7902f__aggregate as parent_metric_cte
)

select
    date_week ,
    name,
    rolling_new_customers,
    test_update  
    
from model_51758de9e889a72967b82e35fea7902f__final
    
order by 1 desc
    
) metric_subq
  );
[0m12:24:53.633663 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m12:24:53.635523 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.metric_test"
[0m12:24:53.635628 [debug] [Thread-1  ]: On model.test_dbt.metric_test: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.metric_test"} */
alter table "test_dbt"."public"."metric_test__dbt_tmp" rename to "metric_test"
[0m12:24:53.636196 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m12:24:53.637013 [debug] [Thread-1  ]: On model.test_dbt.metric_test: COMMIT
[0m12:24:53.637113 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.metric_test"
[0m12:24:53.637194 [debug] [Thread-1  ]: On model.test_dbt.metric_test: COMMIT
[0m12:24:53.638065 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m12:24:53.639409 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.metric_test"
[0m12:24:53.639510 [debug] [Thread-1  ]: On model.test_dbt.metric_test: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.metric_test"} */
drop view if exists "test_dbt"."public"."metric_test__dbt_backup" cascade
[0m12:24:53.639741 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m12:24:53.640319 [debug] [Thread-1  ]: Timing info for model.test_dbt.metric_test (execute): 2023-02-21 12:24:53.596640 => 2023-02-21 12:24:53.640289
[0m12:24:53.640430 [debug] [Thread-1  ]: On model.test_dbt.metric_test: Close
[0m12:24:53.640758 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efe9814b-26e5-41e9-9337-bef9301c9485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114069cd0>]}
[0m12:24:53.640974 [info ] [Thread-1  ]: 3 of 4 OK created sql view model public.metric_test ............................ [[32mCREATE VIEW[0m in 0.16s]
[0m12:24:53.641151 [debug] [Thread-1  ]: Finished running node model.test_dbt.metric_test
[0m12:24:53.641303 [debug] [Thread-1  ]: Began running node model.test_dbt.my_second_dbt_model
[0m12:24:53.641501 [info ] [Thread-1  ]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m12:24:53.641835 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.test_dbt.my_second_dbt_model'
[0m12:24:53.641960 [debug] [Thread-1  ]: Began compiling node model.test_dbt.my_second_dbt_model
[0m12:24:53.643680 [debug] [Thread-1  ]: Writing injected SQL for node "model.test_dbt.my_second_dbt_model"
[0m12:24:53.644078 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_second_dbt_model (compile): 2023-02-21 12:24:53.642041 => 2023-02-21 12:24:53.644047
[0m12:24:53.644213 [debug] [Thread-1  ]: Began executing node model.test_dbt.my_second_dbt_model
[0m12:24:53.646652 [debug] [Thread-1  ]: Writing runtime sql for node "model.test_dbt.my_second_dbt_model"
[0m12:24:53.646982 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_second_dbt_model"
[0m12:24:53.647078 [debug] [Thread-1  ]: On model.test_dbt.my_second_dbt_model: BEGIN
[0m12:24:53.647163 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:24:53.652248 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m12:24:53.652359 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_second_dbt_model"
[0m12:24:53.652440 [debug] [Thread-1  ]: On model.test_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_second_dbt_model"} */

  create view "test_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test_dbt"."public"."my_first_dbt_model"
where id = 1
  );
[0m12:24:53.656514 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m12:24:53.659106 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_second_dbt_model"
[0m12:24:53.659249 [debug] [Thread-1  ]: On model.test_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_second_dbt_model"} */
alter table "test_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:24:53.661708 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m12:24:53.662552 [debug] [Thread-1  ]: On model.test_dbt.my_second_dbt_model: COMMIT
[0m12:24:53.662656 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_second_dbt_model"
[0m12:24:53.662754 [debug] [Thread-1  ]: On model.test_dbt.my_second_dbt_model: COMMIT
[0m12:24:53.663752 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m12:24:53.665071 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_second_dbt_model"
[0m12:24:53.665160 [debug] [Thread-1  ]: On model.test_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_second_dbt_model"} */
drop view if exists "test_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
[0m12:24:53.665476 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m12:24:53.666026 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_second_dbt_model (execute): 2023-02-21 12:24:53.644298 => 2023-02-21 12:24:53.665998
[0m12:24:53.666136 [debug] [Thread-1  ]: On model.test_dbt.my_second_dbt_model: Close
[0m12:24:53.666600 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efe9814b-26e5-41e9-9337-bef9301c9485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fac580>]}
[0m12:24:53.666904 [info ] [Thread-1  ]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.02s]
[0m12:24:53.667105 [debug] [Thread-1  ]: Finished running node model.test_dbt.my_second_dbt_model
[0m12:24:53.667846 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:24:53.668052 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:53.668163 [debug] [MainThread]: On master: BEGIN
[0m12:24:53.668262 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:24:53.674643 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:24:53.674767 [debug] [MainThread]: On master: COMMIT
[0m12:24:53.674866 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:53.674959 [debug] [MainThread]: On master: COMMIT
[0m12:24:53.675156 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:24:53.675260 [debug] [MainThread]: On master: Close
[0m12:24:53.675523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:24:53.675614 [debug] [MainThread]: Connection 'model.test_dbt.my_second_dbt_model' was properly closed.
[0m12:24:53.675734 [info ] [MainThread]: 
[0m12:24:53.675872 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m12:24:53.676114 [debug] [MainThread]: Command end result
[0m12:24:53.681380 [info ] [MainThread]: 
[0m12:24:53.681585 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:24:53.681714 [info ] [MainThread]: 
[0m12:24:53.681826 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:24:53.681988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fd4700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e88f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f85af0>]}
[0m12:24:53.682131 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 12:28:34.888111 | 4301b29d-205e-43d8-8cda-5e44c069e136 ==============================
[0m12:28:34.888111 [info ] [MainThread]: Running with dbt=1.4.1
[0m12:28:34.889240 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rom.weinstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:28:34.889363 [debug] [MainThread]: Tracking: tracking
[0m12:28:34.909483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047c11c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047c1dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047c1790>]}
[0m12:28:34.999101 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:28:34.999322 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:28:35.004003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4301b29d-205e-43d8-8cda-5e44c069e136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b870d0>]}
[0m12:28:35.009241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4301b29d-205e-43d8-8cda-5e44c069e136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a62a00>]}
[0m12:28:35.009424 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 515 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 3 metrics
[0m12:28:35.009560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4301b29d-205e-43d8-8cda-5e44c069e136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a628e0>]}
[0m12:28:35.010224 [info ] [MainThread]: 
[0m12:28:35.011019 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:28:35.011561 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_dbt'
[0m12:28:35.016927 [debug] [ThreadPool]: Using postgres connection "list_test_dbt"
[0m12:28:35.017089 [debug] [ThreadPool]: On list_test_dbt: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "list_test_dbt"} */

    select distinct nspname from pg_namespace
  
[0m12:28:35.017216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:35.063726 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m12:28:35.064546 [debug] [ThreadPool]: On list_test_dbt: Close
[0m12:28:35.065375 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_dbt_public'
[0m12:28:35.069034 [debug] [ThreadPool]: Using postgres connection "list_test_dbt_public"
[0m12:28:35.069188 [debug] [ThreadPool]: On list_test_dbt_public: BEGIN
[0m12:28:35.069301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:35.080538 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m12:28:35.080676 [debug] [ThreadPool]: Using postgres connection "list_test_dbt_public"
[0m12:28:35.080773 [debug] [ThreadPool]: On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "list_test_dbt_public"} */
select
      'test_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m12:28:35.092830 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m12:28:35.093688 [debug] [ThreadPool]: On list_test_dbt_public: ROLLBACK
[0m12:28:35.093998 [debug] [ThreadPool]: On list_test_dbt_public: Close
[0m12:28:35.097684 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:35.097862 [debug] [MainThread]: On master: BEGIN
[0m12:28:35.097980 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:35.104789 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:28:35.104983 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:35.105098 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:28:35.118279 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m12:28:35.119315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4301b29d-205e-43d8-8cda-5e44c069e136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d83a0>]}
[0m12:28:35.119541 [debug] [MainThread]: On master: ROLLBACK
[0m12:28:35.119843 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:35.119967 [debug] [MainThread]: On master: BEGIN
[0m12:28:35.120369 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:28:35.120493 [debug] [MainThread]: On master: COMMIT
[0m12:28:35.120600 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:35.120703 [debug] [MainThread]: On master: COMMIT
[0m12:28:35.120921 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:28:35.121045 [debug] [MainThread]: On master: Close
[0m12:28:35.121376 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:28:35.121533 [info ] [MainThread]: 
[0m12:28:35.123670 [debug] [Thread-1  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m12:28:35.123894 [info ] [Thread-1  ]: 1 of 4 START sql table model public.dbt_metrics_default_calendar ............... [RUN]
[0m12:28:35.124290 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.metrics.dbt_metrics_default_calendar'
[0m12:28:35.124431 [debug] [Thread-1  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m12:28:35.138034 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:28:35.138222 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: BEGIN
[0m12:28:35.138319 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:28:35.146157 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m12:28:35.146300 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:28:35.146400 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 
        ((cast('2030-01-01' as date))::date - (cast('1990-01-01' as date))::date)
    
[0m12:28:35.146996 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m12:28:35.156008 [debug] [Thread-1  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m12:28:35.156507 [debug] [Thread-1  ]: Timing info for model.metrics.dbt_metrics_default_calendar (compile): 2023-02-21 12:28:35.124525 => 2023-02-21 12:28:35.156472
[0m12:28:35.156638 [debug] [Thread-1  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m12:28:35.176602 [debug] [Thread-1  ]: Writing runtime sql for node "model.metrics.dbt_metrics_default_calendar"
[0m12:28:35.177121 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:28:35.177223 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */

  
    

  create  table "test_dbt"."public"."dbt_metrics_default_calendar__dbt_tmp"
  as (
    

with days as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
    
    

    )

    select *
    from unioned
    where generated_number <= 14610
    order by generated_number



),

all_periods as (

    select (
        

    cast('1990-01-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2030-01-01' as date)

)

select * from filtered


),

final as (
    select 
        cast(date_day as date) as date_day,
        cast(date_trunc('week', date_day) as date) as date_week,
        cast(date_trunc('month', date_day) as date) as date_month,
        cast(date_trunc('quarter', date_day) as date) as date_quarter,
        cast(date_trunc('year', date_day) as date) as date_year
    from days
)

select * from final
  );
  
[0m12:28:35.227532 [debug] [Thread-1  ]: SQL status: SELECT 14610 in 0 seconds
[0m12:28:35.231818 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:28:35.231971 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */
alter table "test_dbt"."public"."dbt_metrics_default_calendar" rename to "dbt_metrics_default_calendar__dbt_backup"
[0m12:28:35.232369 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m12:28:35.233924 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:28:35.234031 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */
alter table "test_dbt"."public"."dbt_metrics_default_calendar__dbt_tmp" rename to "dbt_metrics_default_calendar"
[0m12:28:35.234461 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m12:28:35.245230 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: COMMIT
[0m12:28:35.245391 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:28:35.245492 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: COMMIT
[0m12:28:35.246507 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m12:28:35.249363 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:28:35.249502 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */
drop table if exists "test_dbt"."public"."dbt_metrics_default_calendar__dbt_backup" cascade
[0m12:28:35.252050 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m12:28:35.252686 [debug] [Thread-1  ]: Timing info for model.metrics.dbt_metrics_default_calendar (execute): 2023-02-21 12:28:35.156714 => 2023-02-21 12:28:35.252654
[0m12:28:35.252816 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: Close
[0m12:28:35.253181 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4301b29d-205e-43d8-8cda-5e44c069e136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cacc70>]}
[0m12:28:35.253414 [info ] [Thread-1  ]: 1 of 4 OK created sql table model public.dbt_metrics_default_calendar .......... [[32mSELECT 14610[0m in 0.13s]
[0m12:28:35.254217 [debug] [Thread-1  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m12:28:35.254400 [debug] [Thread-1  ]: Began running node model.test_dbt.my_first_dbt_model
[0m12:28:35.254615 [info ] [Thread-1  ]: 2 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m12:28:35.254960 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.test_dbt.my_first_dbt_model'
[0m12:28:35.255087 [debug] [Thread-1  ]: Began compiling node model.test_dbt.my_first_dbt_model
[0m12:28:35.256771 [debug] [Thread-1  ]: Writing injected SQL for node "model.test_dbt.my_first_dbt_model"
[0m12:28:35.257170 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_first_dbt_model (compile): 2023-02-21 12:28:35.255171 => 2023-02-21 12:28:35.257144
[0m12:28:35.257293 [debug] [Thread-1  ]: Began executing node model.test_dbt.my_first_dbt_model
[0m12:28:35.259716 [debug] [Thread-1  ]: Writing runtime sql for node "model.test_dbt.my_first_dbt_model"
[0m12:28:35.260061 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:28:35.260159 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: BEGIN
[0m12:28:35.260246 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:28:35.263243 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m12:28:35.263359 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:28:35.263446 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_first_dbt_model"} */

  
    

  create  table "test_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id,'alexey' as name, '1991-01-01' as date_id, 97 score
    union all
    select 1 as id,'alexey' as name, '1991-01-02' as date_id, 66 score
    union all
    select 2 as id,'sergey' as name, '1991-01-03' as date_id, 50 score

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m12:28:35.265773 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m12:28:35.268126 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:28:35.268233 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_first_dbt_model"} */
alter table "test_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m12:28:35.268746 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m12:28:35.270416 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:28:35.270551 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_first_dbt_model"} */
alter table "test_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:28:35.271050 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m12:28:35.272275 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: COMMIT
[0m12:28:35.272452 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:28:35.272538 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: COMMIT
[0m12:28:35.273214 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m12:28:35.274630 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:28:35.274727 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_first_dbt_model"} */
drop table if exists "test_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
[0m12:28:35.276016 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m12:28:35.276603 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_first_dbt_model (execute): 2023-02-21 12:28:35.257369 => 2023-02-21 12:28:35.276577
[0m12:28:35.276713 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: Close
[0m12:28:35.277040 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4301b29d-205e-43d8-8cda-5e44c069e136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104caca90>]}
[0m12:28:35.277242 [info ] [Thread-1  ]: 2 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 3[0m in 0.02s]
[0m12:28:35.277416 [debug] [Thread-1  ]: Finished running node model.test_dbt.my_first_dbt_model
[0m12:28:35.277919 [debug] [Thread-1  ]: Began running node model.test_dbt.metric_test
[0m12:28:35.278206 [info ] [Thread-1  ]: 3 of 4 START sql view model public.metric_test ................................. [RUN]
[0m12:28:35.278588 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.test_dbt.metric_test'
[0m12:28:35.278732 [debug] [Thread-1  ]: Began compiling node model.test_dbt.metric_test
[0m12:28:35.391918 [debug] [Thread-1  ]: Writing injected SQL for node "model.test_dbt.metric_test"
[0m12:28:35.392508 [debug] [Thread-1  ]: Timing info for model.test_dbt.metric_test (compile): 2023-02-21 12:28:35.278813 => 2023-02-21 12:28:35.392467
[0m12:28:35.392665 [debug] [Thread-1  ]: Began executing node model.test_dbt.metric_test
[0m12:28:35.401906 [debug] [Thread-1  ]: Writing runtime sql for node "model.test_dbt.metric_test"
[0m12:28:35.402339 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.metric_test"
[0m12:28:35.402438 [debug] [Thread-1  ]: On model.test_dbt.metric_test: BEGIN
[0m12:28:35.402525 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:28:35.414907 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m12:28:35.415073 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.metric_test"
[0m12:28:35.415157 [debug] [Thread-1  ]: On model.test_dbt.metric_test: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.metric_test"} */

  create view "test_dbt"."public"."metric_test__dbt_tmp" as (
    select *,

    now() + ((interval '1 ') * (1))


from -- depends on: "test_dbt"."public"."dbt_metrics_default_calendar"

(

with calendar as (
    select 
        * 
    from "test_dbt"."public"."dbt_metrics_default_calendar"
     
)

, model_51758de9e889a72967b82e35fea7902f__aggregate as (
    
    select
        date_week,
        name,
        bool_or(metric_date_day is not null) as has_data,
        sum(property_to_aggregate__rolling_new_customers) as rolling_new_customers,
        max(property_to_aggregate__test_update) as test_update
    from (
        select 
            cast(base_model.date_id as date) as metric_date_day,
            calendar.date_week as date_week,
            calendar.date_day as window_filter_date,
            base_model.name,
            (score) as property_to_aggregate__rolling_new_customers,
            (score) as property_to_aggregate__test_update
        from "test_dbt"."public"."my_first_dbt_model" base_model 
        
        left join calendar
            on cast(base_model.date_id as date) = calendar.date_day
        
        where 1=1
        
    ) as base_query

    where 1=1
    group by 1, 2

), model_51758de9e889a72967b82e35fea7902f__final as (
    
    select
        parent_metric_cte.date_week,
        parent_metric_cte.name,
        coalesce(rolling_new_customers, 0) as rolling_new_customers,
        coalesce(test_update, 0) as test_update
    from model_51758de9e889a72967b82e35fea7902f__aggregate as parent_metric_cte
)

select
    date_week ,
    name,
    rolling_new_customers,
    test_update  
    
from model_51758de9e889a72967b82e35fea7902f__final
    
order by 1 desc
    
) metric_subq
  );
[0m12:28:35.422754 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m12:28:35.424532 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.metric_test"
[0m12:28:35.424645 [debug] [Thread-1  ]: On model.test_dbt.metric_test: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.metric_test"} */
alter table "test_dbt"."public"."metric_test__dbt_tmp" rename to "metric_test"
[0m12:28:35.425397 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m12:28:35.426256 [debug] [Thread-1  ]: On model.test_dbt.metric_test: COMMIT
[0m12:28:35.426366 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.metric_test"
[0m12:28:35.426452 [debug] [Thread-1  ]: On model.test_dbt.metric_test: COMMIT
[0m12:28:35.427291 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m12:28:35.428671 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.metric_test"
[0m12:28:35.428769 [debug] [Thread-1  ]: On model.test_dbt.metric_test: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.metric_test"} */
drop view if exists "test_dbt"."public"."metric_test__dbt_backup" cascade
[0m12:28:35.429011 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m12:28:35.429667 [debug] [Thread-1  ]: Timing info for model.test_dbt.metric_test (execute): 2023-02-21 12:28:35.392750 => 2023-02-21 12:28:35.429640
[0m12:28:35.429796 [debug] [Thread-1  ]: On model.test_dbt.metric_test: Close
[0m12:28:35.430153 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4301b29d-205e-43d8-8cda-5e44c069e136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e0efa0>]}
[0m12:28:35.430373 [info ] [Thread-1  ]: 3 of 4 OK created sql view model public.metric_test ............................ [[32mCREATE VIEW[0m in 0.15s]
[0m12:28:35.430560 [debug] [Thread-1  ]: Finished running node model.test_dbt.metric_test
[0m12:28:35.430711 [debug] [Thread-1  ]: Began running node model.test_dbt.my_second_dbt_model
[0m12:28:35.430851 [info ] [Thread-1  ]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m12:28:35.431193 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.test_dbt.my_second_dbt_model'
[0m12:28:35.431306 [debug] [Thread-1  ]: Began compiling node model.test_dbt.my_second_dbt_model
[0m12:28:35.433449 [debug] [Thread-1  ]: Writing injected SQL for node "model.test_dbt.my_second_dbt_model"
[0m12:28:35.433950 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_second_dbt_model (compile): 2023-02-21 12:28:35.431379 => 2023-02-21 12:28:35.433922
[0m12:28:35.434072 [debug] [Thread-1  ]: Began executing node model.test_dbt.my_second_dbt_model
[0m12:28:35.436350 [debug] [Thread-1  ]: Writing runtime sql for node "model.test_dbt.my_second_dbt_model"
[0m12:28:35.436730 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_second_dbt_model"
[0m12:28:35.436832 [debug] [Thread-1  ]: On model.test_dbt.my_second_dbt_model: BEGIN
[0m12:28:35.436918 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:28:35.445854 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m12:28:35.446012 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_second_dbt_model"
[0m12:28:35.446097 [debug] [Thread-1  ]: On model.test_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_second_dbt_model"} */

  create view "test_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test_dbt"."public"."my_first_dbt_model"
where id = 1
  );
[0m12:28:35.454806 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m12:28:35.456725 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_second_dbt_model"
[0m12:28:35.456849 [debug] [Thread-1  ]: On model.test_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_second_dbt_model"} */
alter table "test_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:28:35.460959 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m12:28:35.461781 [debug] [Thread-1  ]: On model.test_dbt.my_second_dbt_model: COMMIT
[0m12:28:35.461883 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_second_dbt_model"
[0m12:28:35.461965 [debug] [Thread-1  ]: On model.test_dbt.my_second_dbt_model: COMMIT
[0m12:28:35.462689 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m12:28:35.463983 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_second_dbt_model"
[0m12:28:35.464088 [debug] [Thread-1  ]: On model.test_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_second_dbt_model"} */
drop view if exists "test_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
[0m12:28:35.464574 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m12:28:35.465149 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_second_dbt_model (execute): 2023-02-21 12:28:35.434147 => 2023-02-21 12:28:35.465120
[0m12:28:35.465252 [debug] [Thread-1  ]: On model.test_dbt.my_second_dbt_model: Close
[0m12:28:35.465567 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4301b29d-205e-43d8-8cda-5e44c069e136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104caca00>]}
[0m12:28:35.465773 [info ] [Thread-1  ]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.03s]
[0m12:28:35.465944 [debug] [Thread-1  ]: Finished running node model.test_dbt.my_second_dbt_model
[0m12:28:35.466568 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:28:35.466700 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:35.466793 [debug] [MainThread]: On master: BEGIN
[0m12:28:35.466883 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:28:35.504567 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:28:35.504797 [debug] [MainThread]: On master: COMMIT
[0m12:28:35.504906 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:35.505004 [debug] [MainThread]: On master: COMMIT
[0m12:28:35.507060 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:28:35.507173 [debug] [MainThread]: On master: Close
[0m12:28:35.507480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:35.507570 [debug] [MainThread]: Connection 'model.test_dbt.my_second_dbt_model' was properly closed.
[0m12:28:35.507697 [info ] [MainThread]: 
[0m12:28:35.507827 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m12:28:35.508060 [debug] [MainThread]: Command end result
[0m12:28:35.513214 [info ] [MainThread]: 
[0m12:28:35.513388 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:28:35.513506 [info ] [MainThread]: 
[0m12:28:35.513621 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:28:35.513785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eeed30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a62670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c3ef70>]}
[0m12:28:35.513948 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 12:34:49.967216 | 094516c9-6ad6-43ad-86b0-4140ca53cd75 ==============================
[0m12:34:49.967216 [info ] [MainThread]: Running with dbt=1.4.1
[0m12:34:49.967925 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rom.weinstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'skip_profile_setup': False, 'which': 'init', 'indirect_selection': 'eager'}
[0m12:34:49.968023 [debug] [MainThread]: Tracking: tracking
[0m12:34:49.995460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a311340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a31e130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a31e760>]}
[0m12:34:49.996206 [info ] [MainThread]: Setting up your profile.
[0m12:34:54.973597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a311340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a318400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a318970>]}
[0m12:34:54.974035 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 12:35:00.775068 | 4452b19a-0e44-4345-b971-09e093ed9317 ==============================
[0m12:35:00.775068 [info ] [MainThread]: Running with dbt=1.4.1
[0m12:35:00.776302 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rom.weinstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:35:00.776422 [debug] [MainThread]: Tracking: tracking
[0m12:35:00.794345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043f2eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104460b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044299d0>]}
[0m12:35:00.882240 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:35:00.882431 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:35:00.886968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4452b19a-0e44-4345-b971-09e093ed9317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049850d0>]}
[0m12:35:00.896417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4452b19a-0e44-4345-b971-09e093ed9317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048cdbb0>]}
[0m12:35:00.896627 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 515 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 3 metrics
[0m12:35:00.896768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4452b19a-0e44-4345-b971-09e093ed9317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048cda90>]}
[0m12:35:00.897478 [info ] [MainThread]: 
[0m12:35:00.898305 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:35:00.898911 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_dbt'
[0m12:35:00.905167 [debug] [ThreadPool]: Using postgres connection "list_test_dbt"
[0m12:35:00.905411 [debug] [ThreadPool]: On list_test_dbt: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "list_test_dbt"} */

    select distinct nspname from pg_namespace
  
[0m12:35:00.905520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:00.964367 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m12:35:00.965267 [debug] [ThreadPool]: On list_test_dbt: Close
[0m12:35:00.966204 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_dbt_public'
[0m12:35:00.970374 [debug] [ThreadPool]: Using postgres connection "list_test_dbt_public"
[0m12:35:00.970532 [debug] [ThreadPool]: On list_test_dbt_public: BEGIN
[0m12:35:00.970650 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:01.002484 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m12:35:01.002696 [debug] [ThreadPool]: Using postgres connection "list_test_dbt_public"
[0m12:35:01.002816 [debug] [ThreadPool]: On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "list_test_dbt_public"} */
select
      'test_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m12:35:01.008184 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m12:35:01.008998 [debug] [ThreadPool]: On list_test_dbt_public: ROLLBACK
[0m12:35:01.016417 [debug] [ThreadPool]: On list_test_dbt_public: Close
[0m12:35:01.020695 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:01.020853 [debug] [MainThread]: On master: BEGIN
[0m12:35:01.020984 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:35:01.027941 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:35:01.028101 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:01.028223 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:35:01.036306 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m12:35:01.037333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4452b19a-0e44-4345-b971-09e093ed9317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046f9250>]}
[0m12:35:01.037578 [debug] [MainThread]: On master: ROLLBACK
[0m12:35:01.037863 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:01.037995 [debug] [MainThread]: On master: BEGIN
[0m12:35:01.038340 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:35:01.038472 [debug] [MainThread]: On master: COMMIT
[0m12:35:01.038594 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:01.038708 [debug] [MainThread]: On master: COMMIT
[0m12:35:01.038966 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:35:01.039154 [debug] [MainThread]: On master: Close
[0m12:35:01.039542 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:35:01.039738 [info ] [MainThread]: 
[0m12:35:01.041962 [debug] [Thread-1  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m12:35:01.042188 [info ] [Thread-1  ]: 1 of 4 START sql table model public.dbt_metrics_default_calendar ............... [RUN]
[0m12:35:01.042563 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.metrics.dbt_metrics_default_calendar'
[0m12:35:01.042703 [debug] [Thread-1  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m12:35:01.057248 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:35:01.057427 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: BEGIN
[0m12:35:01.057528 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:35:01.067220 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m12:35:01.067370 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:35:01.067466 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 
        ((cast('2030-01-01' as date))::date - (cast('1990-01-01' as date))::date)
    
[0m12:35:01.067974 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m12:35:01.077301 [debug] [Thread-1  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m12:35:01.077702 [debug] [Thread-1  ]: Timing info for model.metrics.dbt_metrics_default_calendar (compile): 2023-02-21 12:35:01.042794 => 2023-02-21 12:35:01.077667
[0m12:35:01.077835 [debug] [Thread-1  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m12:35:01.099322 [debug] [Thread-1  ]: Writing runtime sql for node "model.metrics.dbt_metrics_default_calendar"
[0m12:35:01.099919 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:35:01.100020 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */

  
    

  create  table "test_dbt"."public"."dbt_metrics_default_calendar__dbt_tmp"
  as (
    

with days as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
    
    

    )

    select *
    from unioned
    where generated_number <= 14610
    order by generated_number



),

all_periods as (

    select (
        

    cast('1990-01-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2030-01-01' as date)

)

select * from filtered


),

final as (
    select 
        cast(date_day as date) as date_day,
        cast(date_trunc('week', date_day) as date) as date_week,
        cast(date_trunc('month', date_day) as date) as date_month,
        cast(date_trunc('quarter', date_day) as date) as date_quarter,
        cast(date_trunc('year', date_day) as date) as date_year
    from days
)

select * from final
  );
  
[0m12:35:01.149840 [debug] [Thread-1  ]: SQL status: SELECT 14610 in 0 seconds
[0m12:35:01.154916 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:35:01.155064 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */
alter table "test_dbt"."public"."dbt_metrics_default_calendar" rename to "dbt_metrics_default_calendar__dbt_backup"
[0m12:35:01.155516 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m12:35:01.157288 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:35:01.157397 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */
alter table "test_dbt"."public"."dbt_metrics_default_calendar__dbt_tmp" rename to "dbt_metrics_default_calendar"
[0m12:35:01.157831 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m12:35:01.170028 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: COMMIT
[0m12:35:01.170203 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:35:01.170297 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: COMMIT
[0m12:35:01.171203 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m12:35:01.174146 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:35:01.174271 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */
drop table if exists "test_dbt"."public"."dbt_metrics_default_calendar__dbt_backup" cascade
[0m12:35:01.176410 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m12:35:01.177089 [debug] [Thread-1  ]: Timing info for model.metrics.dbt_metrics_default_calendar (execute): 2023-02-21 12:35:01.077913 => 2023-02-21 12:35:01.177059
[0m12:35:01.177210 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: Close
[0m12:35:01.177549 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4452b19a-0e44-4345-b971-09e093ed9317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aa6d90>]}
[0m12:35:01.177772 [info ] [Thread-1  ]: 1 of 4 OK created sql table model public.dbt_metrics_default_calendar .......... [[32mSELECT 14610[0m in 0.14s]
[0m12:35:01.178519 [debug] [Thread-1  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m12:35:01.178701 [debug] [Thread-1  ]: Began running node model.test_dbt.my_first_dbt_model
[0m12:35:01.178904 [info ] [Thread-1  ]: 2 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m12:35:01.179246 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.test_dbt.my_first_dbt_model'
[0m12:35:01.179372 [debug] [Thread-1  ]: Began compiling node model.test_dbt.my_first_dbt_model
[0m12:35:01.181072 [debug] [Thread-1  ]: Writing injected SQL for node "model.test_dbt.my_first_dbt_model"
[0m12:35:01.181489 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_first_dbt_model (compile): 2023-02-21 12:35:01.179452 => 2023-02-21 12:35:01.181463
[0m12:35:01.181606 [debug] [Thread-1  ]: Began executing node model.test_dbt.my_first_dbt_model
[0m12:35:01.184011 [debug] [Thread-1  ]: Writing runtime sql for node "model.test_dbt.my_first_dbt_model"
[0m12:35:01.184325 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:35:01.184410 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: BEGIN
[0m12:35:01.184494 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:35:01.188014 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m12:35:01.188119 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:35:01.188200 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_first_dbt_model"} */

  
    

  create  table "test_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id,'alexey' as name, '1991-01-01' as date_id, 97 score
    union all
    select 1 as id,'alexey' as name, '1991-01-02' as date_id, 66 score
    union all
    select 2 as id,'sergey' as name, '1991-01-03' as date_id, 50 score

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m12:35:01.190358 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m12:35:01.192681 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:35:01.192786 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_first_dbt_model"} */
alter table "test_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m12:35:01.193064 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m12:35:01.194586 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:35:01.194680 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_first_dbt_model"} */
alter table "test_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:35:01.194977 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m12:35:01.196080 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: COMMIT
[0m12:35:01.196195 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:35:01.196276 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: COMMIT
[0m12:35:01.196638 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m12:35:01.198168 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:35:01.198355 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_first_dbt_model"} */
drop table if exists "test_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
[0m12:35:01.200029 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m12:35:01.200764 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_first_dbt_model (execute): 2023-02-21 12:35:01.181680 => 2023-02-21 12:35:01.200737
[0m12:35:01.200890 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: Close
[0m12:35:01.201219 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4452b19a-0e44-4345-b971-09e093ed9317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aa6df0>]}
[0m12:35:01.201426 [info ] [Thread-1  ]: 2 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 3[0m in 0.02s]
[0m12:35:01.201610 [debug] [Thread-1  ]: Finished running node model.test_dbt.my_first_dbt_model
[0m12:35:01.202018 [debug] [Thread-1  ]: Began running node model.test_dbt.metric_test
[0m12:35:01.202248 [info ] [Thread-1  ]: 3 of 4 START sql view model public.metric_test ................................. [RUN]
[0m12:35:01.202573 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.test_dbt.metric_test'
[0m12:35:01.202773 [debug] [Thread-1  ]: Began compiling node model.test_dbt.metric_test
[0m12:35:01.318601 [debug] [Thread-1  ]: Writing injected SQL for node "model.test_dbt.metric_test"
[0m12:35:01.319166 [debug] [Thread-1  ]: Timing info for model.test_dbt.metric_test (compile): 2023-02-21 12:35:01.202897 => 2023-02-21 12:35:01.319129
[0m12:35:01.319319 [debug] [Thread-1  ]: Began executing node model.test_dbt.metric_test
[0m12:35:01.328455 [debug] [Thread-1  ]: Writing runtime sql for node "model.test_dbt.metric_test"
[0m12:35:01.328835 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.metric_test"
[0m12:35:01.328931 [debug] [Thread-1  ]: On model.test_dbt.metric_test: BEGIN
[0m12:35:01.329019 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:35:01.341743 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m12:35:01.341854 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.metric_test"
[0m12:35:01.341933 [debug] [Thread-1  ]: On model.test_dbt.metric_test: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.metric_test"} */

  create view "test_dbt"."public"."metric_test__dbt_tmp" as (
    select *,

    now() + ((interval '1 ') * (1))


from -- depends on: "test_dbt"."public"."dbt_metrics_default_calendar"

(

with calendar as (
    select 
        * 
    from "test_dbt"."public"."dbt_metrics_default_calendar"
     
)

, model_51758de9e889a72967b82e35fea7902f__aggregate as (
    
    select
        date_week,
        name,
        bool_or(metric_date_day is not null) as has_data,
        sum(property_to_aggregate__rolling_new_customers) as rolling_new_customers,
        max(property_to_aggregate__test_update) as test_update
    from (
        select 
            cast(base_model.date_id as date) as metric_date_day,
            calendar.date_week as date_week,
            calendar.date_day as window_filter_date,
            base_model.name,
            (score) as property_to_aggregate__rolling_new_customers,
            (score) as property_to_aggregate__test_update
        from "test_dbt"."public"."my_first_dbt_model" base_model 
        
        left join calendar
            on cast(base_model.date_id as date) = calendar.date_day
        
        where 1=1
        
    ) as base_query

    where 1=1
    group by 1, 2

), model_51758de9e889a72967b82e35fea7902f__final as (
    
    select
        parent_metric_cte.date_week,
        parent_metric_cte.name,
        coalesce(rolling_new_customers, 0) as rolling_new_customers,
        coalesce(test_update, 0) as test_update
    from model_51758de9e889a72967b82e35fea7902f__aggregate as parent_metric_cte
)

select
    date_week ,
    name,
    rolling_new_customers,
    test_update  
    
from model_51758de9e889a72967b82e35fea7902f__final
    
order by 1 desc
    
) metric_subq
  );
[0m12:35:01.363344 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m12:35:01.365275 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.metric_test"
[0m12:35:01.365383 [debug] [Thread-1  ]: On model.test_dbt.metric_test: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.metric_test"} */
alter table "test_dbt"."public"."metric_test__dbt_tmp" rename to "metric_test"
[0m12:35:01.376254 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m12:35:01.377177 [debug] [Thread-1  ]: On model.test_dbt.metric_test: COMMIT
[0m12:35:01.377290 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.metric_test"
[0m12:35:01.377383 [debug] [Thread-1  ]: On model.test_dbt.metric_test: COMMIT
[0m12:35:01.379030 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m12:35:01.380614 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.metric_test"
[0m12:35:01.380737 [debug] [Thread-1  ]: On model.test_dbt.metric_test: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.metric_test"} */
drop view if exists "test_dbt"."public"."metric_test__dbt_backup" cascade
[0m12:35:01.381170 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m12:35:01.381893 [debug] [Thread-1  ]: Timing info for model.test_dbt.metric_test (execute): 2023-02-21 12:35:01.319400 => 2023-02-21 12:35:01.381862
[0m12:35:01.382033 [debug] [Thread-1  ]: On model.test_dbt.metric_test: Close
[0m12:35:01.382414 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4452b19a-0e44-4345-b971-09e093ed9317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aa6c10>]}
[0m12:35:01.382659 [info ] [Thread-1  ]: 3 of 4 OK created sql view model public.metric_test ............................ [[32mCREATE VIEW[0m in 0.18s]
[0m12:35:01.382857 [debug] [Thread-1  ]: Finished running node model.test_dbt.metric_test
[0m12:35:01.383029 [debug] [Thread-1  ]: Began running node model.test_dbt.my_second_dbt_model
[0m12:35:01.383319 [info ] [Thread-1  ]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m12:35:01.383777 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.test_dbt.my_second_dbt_model'
[0m12:35:01.383921 [debug] [Thread-1  ]: Began compiling node model.test_dbt.my_second_dbt_model
[0m12:35:01.386445 [debug] [Thread-1  ]: Writing injected SQL for node "model.test_dbt.my_second_dbt_model"
[0m12:35:01.386927 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_second_dbt_model (compile): 2023-02-21 12:35:01.384012 => 2023-02-21 12:35:01.386885
[0m12:35:01.387102 [debug] [Thread-1  ]: Began executing node model.test_dbt.my_second_dbt_model
[0m12:35:01.390012 [debug] [Thread-1  ]: Writing runtime sql for node "model.test_dbt.my_second_dbt_model"
[0m12:35:01.390364 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_second_dbt_model"
[0m12:35:01.390465 [debug] [Thread-1  ]: On model.test_dbt.my_second_dbt_model: BEGIN
[0m12:35:01.390559 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:35:01.401872 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m12:35:01.402076 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_second_dbt_model"
[0m12:35:01.402188 [debug] [Thread-1  ]: On model.test_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_second_dbt_model"} */

  create view "test_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test_dbt"."public"."my_first_dbt_model"
where id = 1
  );
[0m12:35:01.404981 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m12:35:01.407124 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_second_dbt_model"
[0m12:35:01.407253 [debug] [Thread-1  ]: On model.test_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_second_dbt_model"} */
alter table "test_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:35:01.407752 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m12:35:01.408633 [debug] [Thread-1  ]: On model.test_dbt.my_second_dbt_model: COMMIT
[0m12:35:01.408740 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_second_dbt_model"
[0m12:35:01.408830 [debug] [Thread-1  ]: On model.test_dbt.my_second_dbt_model: COMMIT
[0m12:35:01.409601 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m12:35:01.411045 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_second_dbt_model"
[0m12:35:01.411148 [debug] [Thread-1  ]: On model.test_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_second_dbt_model"} */
drop view if exists "test_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
[0m12:35:01.411449 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m12:35:01.412185 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_second_dbt_model (execute): 2023-02-21 12:35:01.387189 => 2023-02-21 12:35:01.412154
[0m12:35:01.412325 [debug] [Thread-1  ]: On model.test_dbt.my_second_dbt_model: Close
[0m12:35:01.412706 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4452b19a-0e44-4345-b971-09e093ed9317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bedf10>]}
[0m12:35:01.412942 [info ] [Thread-1  ]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.03s]
[0m12:35:01.413136 [debug] [Thread-1  ]: Finished running node model.test_dbt.my_second_dbt_model
[0m12:35:01.413967 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:35:01.414128 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:01.414237 [debug] [MainThread]: On master: BEGIN
[0m12:35:01.414342 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:35:01.420336 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:35:01.420485 [debug] [MainThread]: On master: COMMIT
[0m12:35:01.420590 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:01.420689 [debug] [MainThread]: On master: COMMIT
[0m12:35:01.420907 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:35:01.421021 [debug] [MainThread]: On master: Close
[0m12:35:01.421301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:01.421395 [debug] [MainThread]: Connection 'model.test_dbt.my_second_dbt_model' was properly closed.
[0m12:35:01.421524 [info ] [MainThread]: 
[0m12:35:01.421663 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m12:35:01.421920 [debug] [MainThread]: Command end result
[0m12:35:01.427430 [info ] [MainThread]: 
[0m12:35:01.427621 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:35:01.427748 [info ] [MainThread]: 
[0m12:35:01.427862 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:35:01.428050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a543d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046f9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a8f9d0>]}
[0m12:35:01.428210 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 12:35:07.719921 | 7759900f-cd30-4d70-a987-011641f08774 ==============================
[0m12:35:07.719921 [info ] [MainThread]: Running with dbt=1.4.1
[0m12:35:07.721144 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rom.weinstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m12:35:07.721267 [debug] [MainThread]: Tracking: tracking
[0m12:35:07.735765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113890d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113858a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ab4fa0>]}
[0m12:35:07.834270 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:35:07.834479 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:35:07.838921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7759900f-cd30-4d70-a987-011641f08774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e870d0>]}
[0m12:35:07.844353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7759900f-cd30-4d70-a987-011641f08774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dd0c40>]}
[0m12:35:07.844566 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 515 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 3 metrics
[0m12:35:07.844708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7759900f-cd30-4d70-a987-011641f08774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dd0b20>]}
[0m12:35:07.845418 [info ] [MainThread]: 
[0m12:35:07.846218 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:35:07.846720 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_dbt_public'
[0m12:35:07.852164 [debug] [ThreadPool]: Using postgres connection "list_test_dbt_public"
[0m12:35:07.852383 [debug] [ThreadPool]: On list_test_dbt_public: BEGIN
[0m12:35:07.852589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:07.862984 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m12:35:07.863163 [debug] [ThreadPool]: Using postgres connection "list_test_dbt_public"
[0m12:35:07.863264 [debug] [ThreadPool]: On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "list_test_dbt_public"} */
select
      'test_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m12:35:07.868207 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m12:35:07.869054 [debug] [ThreadPool]: On list_test_dbt_public: ROLLBACK
[0m12:35:07.869352 [debug] [ThreadPool]: On list_test_dbt_public: Close
[0m12:35:07.873072 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:07.873240 [debug] [MainThread]: On master: BEGIN
[0m12:35:07.873347 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:35:07.878018 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:35:07.878137 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:07.878230 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:35:07.895545 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m12:35:07.896543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7759900f-cd30-4d70-a987-011641f08774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113890d00>]}
[0m12:35:07.896743 [debug] [MainThread]: On master: ROLLBACK
[0m12:35:07.897048 [debug] [MainThread]: On master: Close
[0m12:35:07.897360 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:35:07.897500 [info ] [MainThread]: 
[0m12:35:07.899618 [debug] [Thread-1  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m12:35:07.899988 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.metrics.dbt_metrics_default_calendar'
[0m12:35:07.900121 [debug] [Thread-1  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m12:35:07.913197 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:35:07.913384 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: BEGIN
[0m12:35:07.913489 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:35:07.920662 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m12:35:07.920884 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:35:07.920990 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 
        ((cast('2030-01-01' as date))::date - (cast('1990-01-01' as date))::date)
    
[0m12:35:07.921797 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m12:35:07.930758 [debug] [Thread-1  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m12:35:07.931338 [debug] [Thread-1  ]: Timing info for model.metrics.dbt_metrics_default_calendar (compile): 2023-02-21 12:35:07.900208 => 2023-02-21 12:35:07.931299
[0m12:35:07.931514 [debug] [Thread-1  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m12:35:07.931645 [debug] [Thread-1  ]: Timing info for model.metrics.dbt_metrics_default_calendar (execute): 2023-02-21 12:35:07.931617 => 2023-02-21 12:35:07.931626
[0m12:35:07.931760 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: ROLLBACK
[0m12:35:07.932155 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: Close
[0m12:35:07.933036 [debug] [Thread-1  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m12:35:07.933202 [debug] [Thread-1  ]: Began running node model.test_dbt.my_first_dbt_model
[0m12:35:07.933570 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.test_dbt.my_first_dbt_model'
[0m12:35:07.933688 [debug] [Thread-1  ]: Began compiling node model.test_dbt.my_first_dbt_model
[0m12:35:07.935210 [debug] [Thread-1  ]: Writing injected SQL for node "model.test_dbt.my_first_dbt_model"
[0m12:35:07.935589 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_first_dbt_model (compile): 2023-02-21 12:35:07.933762 => 2023-02-21 12:35:07.935565
[0m12:35:07.935701 [debug] [Thread-1  ]: Began executing node model.test_dbt.my_first_dbt_model
[0m12:35:07.935790 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_first_dbt_model (execute): 2023-02-21 12:35:07.935772 => 2023-02-21 12:35:07.935775
[0m12:35:07.936071 [debug] [Thread-1  ]: Finished running node model.test_dbt.my_first_dbt_model
[0m12:35:07.936397 [debug] [Thread-1  ]: Began running node model.test_dbt.metric_test
[0m12:35:07.936675 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.test_dbt.metric_test'
[0m12:35:07.936777 [debug] [Thread-1  ]: Began compiling node model.test_dbt.metric_test
[0m12:35:08.050721 [debug] [Thread-1  ]: Writing injected SQL for node "model.test_dbt.metric_test"
[0m12:35:08.051315 [debug] [Thread-1  ]: Timing info for model.test_dbt.metric_test (compile): 2023-02-21 12:35:07.936852 => 2023-02-21 12:35:08.051279
[0m12:35:08.051443 [debug] [Thread-1  ]: Began executing node model.test_dbt.metric_test
[0m12:35:08.051544 [debug] [Thread-1  ]: Timing info for model.test_dbt.metric_test (execute): 2023-02-21 12:35:08.051522 => 2023-02-21 12:35:08.051529
[0m12:35:08.051875 [debug] [Thread-1  ]: Finished running node model.test_dbt.metric_test
[0m12:35:08.052015 [debug] [Thread-1  ]: Began running node model.test_dbt.my_second_dbt_model
[0m12:35:08.052243 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.test_dbt.my_second_dbt_model'
[0m12:35:08.052346 [debug] [Thread-1  ]: Began compiling node model.test_dbt.my_second_dbt_model
[0m12:35:08.053842 [debug] [Thread-1  ]: Writing injected SQL for node "model.test_dbt.my_second_dbt_model"
[0m12:35:08.054123 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_second_dbt_model (compile): 2023-02-21 12:35:08.052413 => 2023-02-21 12:35:08.054097
[0m12:35:08.054226 [debug] [Thread-1  ]: Began executing node model.test_dbt.my_second_dbt_model
[0m12:35:08.054309 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_second_dbt_model (execute): 2023-02-21 12:35:08.054292 => 2023-02-21 12:35:08.054295
[0m12:35:08.054574 [debug] [Thread-1  ]: Finished running node model.test_dbt.my_second_dbt_model
[0m12:35:08.054704 [debug] [Thread-1  ]: Began running node test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:35:08.054915 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710'
[0m12:35:08.055009 [debug] [Thread-1  ]: Began compiling node test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:35:08.061423 [debug] [Thread-1  ]: Writing injected SQL for node "test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:35:08.061959 [debug] [Thread-1  ]: Timing info for test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 2023-02-21 12:35:08.055076 => 2023-02-21 12:35:08.061932
[0m12:35:08.062081 [debug] [Thread-1  ]: Began executing node test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:35:08.062171 [debug] [Thread-1  ]: Timing info for test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 2023-02-21 12:35:08.062152 => 2023-02-21 12:35:08.062156
[0m12:35:08.062450 [debug] [Thread-1  ]: Finished running node test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:35:08.062578 [debug] [Thread-1  ]: Began running node test.test_dbt.unique_my_first_dbt_model_id.16e066b321
[0m12:35:08.062798 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.test_dbt.unique_my_first_dbt_model_id.16e066b321'
[0m12:35:08.062896 [debug] [Thread-1  ]: Began compiling node test.test_dbt.unique_my_first_dbt_model_id.16e066b321
[0m12:35:08.066082 [debug] [Thread-1  ]: Writing injected SQL for node "test.test_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m12:35:08.066401 [debug] [Thread-1  ]: Timing info for test.test_dbt.unique_my_first_dbt_model_id.16e066b321 (compile): 2023-02-21 12:35:08.062963 => 2023-02-21 12:35:08.066380
[0m12:35:08.066508 [debug] [Thread-1  ]: Began executing node test.test_dbt.unique_my_first_dbt_model_id.16e066b321
[0m12:35:08.066597 [debug] [Thread-1  ]: Timing info for test.test_dbt.unique_my_first_dbt_model_id.16e066b321 (execute): 2023-02-21 12:35:08.066578 => 2023-02-21 12:35:08.066581
[0m12:35:08.066871 [debug] [Thread-1  ]: Finished running node test.test_dbt.unique_my_first_dbt_model_id.16e066b321
[0m12:35:08.067002 [debug] [Thread-1  ]: Began running node test.test_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m12:35:08.067240 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.test_dbt.not_null_my_second_dbt_model_id.151b76d778'
[0m12:35:08.067337 [debug] [Thread-1  ]: Began compiling node test.test_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m12:35:08.069421 [debug] [Thread-1  ]: Writing injected SQL for node "test.test_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m12:35:08.069667 [debug] [Thread-1  ]: Timing info for test.test_dbt.not_null_my_second_dbt_model_id.151b76d778 (compile): 2023-02-21 12:35:08.067404 => 2023-02-21 12:35:08.069647
[0m12:35:08.069771 [debug] [Thread-1  ]: Began executing node test.test_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m12:35:08.069855 [debug] [Thread-1  ]: Timing info for test.test_dbt.not_null_my_second_dbt_model_id.151b76d778 (execute): 2023-02-21 12:35:08.069838 => 2023-02-21 12:35:08.069841
[0m12:35:08.070119 [debug] [Thread-1  ]: Finished running node test.test_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m12:35:08.070249 [debug] [Thread-1  ]: Began running node test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m12:35:08.070483 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493'
[0m12:35:08.070579 [debug] [Thread-1  ]: Began compiling node test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m12:35:08.072628 [debug] [Thread-1  ]: Writing injected SQL for node "test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:35:08.072883 [debug] [Thread-1  ]: Timing info for test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493 (compile): 2023-02-21 12:35:08.070647 => 2023-02-21 12:35:08.072864
[0m12:35:08.072985 [debug] [Thread-1  ]: Began executing node test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m12:35:08.073076 [debug] [Thread-1  ]: Timing info for test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493 (execute): 2023-02-21 12:35:08.073058 => 2023-02-21 12:35:08.073061
[0m12:35:08.073339 [debug] [Thread-1  ]: Finished running node test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m12:35:08.073751 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:08.073868 [debug] [MainThread]: Connection 'test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m12:35:08.074145 [debug] [MainThread]: Command end result
[0m12:35:08.078872 [info ] [MainThread]: Done.
[0m12:35:08.079066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e9f640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d6bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d6b670>]}
[0m12:35:08.079208 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 12:55:43.012232 | c28035bf-5af2-4d33-b968-13b387958556 ==============================
[0m12:55:43.012232 [info ] [MainThread]: Running with dbt=1.4.1
[0m12:55:43.012895 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rom.weinstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'skip_profile_setup': False, 'which': 'init', 'indirect_selection': 'eager'}
[0m12:55:43.012991 [debug] [MainThread]: Tracking: tracking
[0m12:55:43.032885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125dd700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125ddbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125ddd90>]}
[0m12:55:43.033715 [info ] [MainThread]: Setting up your profile.
[0m12:55:47.622062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11046b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11281ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125cc310>]}
[0m12:55:47.622324 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 12:57:28.623303 | a244f9d3-a0f3-4f51-9b9f-e381fbc83d1c ==============================
[0m12:57:28.623303 [info ] [MainThread]: Running with dbt=1.4.1
[0m12:57:28.624495 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rom.weinstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m12:57:28.624613 [debug] [MainThread]: Tracking: tracking
[0m12:57:28.647752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107850ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107819e20>]}
[0m12:57:28.736830 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:57:28.737025 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:57:28.740902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a244f9d3-a0f3-4f51-9b9f-e381fbc83d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e330d0>]}
[0m12:57:28.747588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a244f9d3-a0f3-4f51-9b9f-e381fbc83d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d7fb20>]}
[0m12:57:28.747838 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 515 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 3 metrics
[0m12:57:28.747994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a244f9d3-a0f3-4f51-9b9f-e381fbc83d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d7fac0>]}
[0m12:57:28.748779 [info ] [MainThread]: 
[0m12:57:28.749630 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:57:28.750209 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_dbt'
[0m12:57:28.755830 [debug] [ThreadPool]: Using postgres connection "list_test_dbt"
[0m12:57:28.755993 [debug] [ThreadPool]: On list_test_dbt: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "list_test_dbt"} */

    select distinct nspname from pg_namespace
  
[0m12:57:28.756122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:28.814309 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m12:57:28.815287 [debug] [ThreadPool]: On list_test_dbt: Close
[0m12:57:28.816289 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_dbt_public'
[0m12:57:28.820543 [debug] [ThreadPool]: Using postgres connection "list_test_dbt_public"
[0m12:57:28.820758 [debug] [ThreadPool]: On list_test_dbt_public: BEGIN
[0m12:57:28.820884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:28.827748 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m12:57:28.827901 [debug] [ThreadPool]: Using postgres connection "list_test_dbt_public"
[0m12:57:28.828014 [debug] [ThreadPool]: On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "list_test_dbt_public"} */
select
      'test_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m12:57:28.830204 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m12:57:28.830977 [debug] [ThreadPool]: On list_test_dbt_public: ROLLBACK
[0m12:57:28.831261 [debug] [ThreadPool]: On list_test_dbt_public: Close
[0m12:57:28.834944 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:28.835112 [debug] [MainThread]: On master: BEGIN
[0m12:57:28.835230 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:28.838410 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:57:28.838544 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:28.838649 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:57:28.871902 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m12:57:28.873222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a244f9d3-a0f3-4f51-9b9f-e381fbc83d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba79d0>]}
[0m12:57:28.873514 [debug] [MainThread]: On master: ROLLBACK
[0m12:57:28.874252 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:28.874446 [debug] [MainThread]: On master: BEGIN
[0m12:57:28.874844 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:57:28.874981 [debug] [MainThread]: On master: COMMIT
[0m12:57:28.875101 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:28.875211 [debug] [MainThread]: On master: COMMIT
[0m12:57:28.875447 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:57:28.875583 [debug] [MainThread]: On master: Close
[0m12:57:28.875954 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:57:28.876121 [info ] [MainThread]: 
[0m12:57:28.878386 [debug] [Thread-1  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m12:57:28.878698 [info ] [Thread-1  ]: 1 of 8 START sql table model public.dbt_metrics_default_calendar ............... [RUN]
[0m12:57:28.879147 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.metrics.dbt_metrics_default_calendar'
[0m12:57:28.879297 [debug] [Thread-1  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m12:57:28.894149 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:57:28.894349 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: BEGIN
[0m12:57:28.894457 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:57:28.906096 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m12:57:28.906550 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:57:28.906673 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 
        ((cast('2030-01-01' as date))::date - (cast('1990-01-01' as date))::date)
    
[0m12:57:28.907591 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m12:57:28.917464 [debug] [Thread-1  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m12:57:28.918131 [debug] [Thread-1  ]: Timing info for model.metrics.dbt_metrics_default_calendar (compile): 2023-02-21 12:57:28.879395 => 2023-02-21 12:57:28.918065
[0m12:57:28.918319 [debug] [Thread-1  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m12:57:28.940655 [debug] [Thread-1  ]: Writing runtime sql for node "model.metrics.dbt_metrics_default_calendar"
[0m12:57:28.941730 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:57:28.941939 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */

  
    

  create  table "test_dbt"."public"."dbt_metrics_default_calendar__dbt_tmp"
  as (
    

with days as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
    
    

    )

    select *
    from unioned
    where generated_number <= 14610
    order by generated_number



),

all_periods as (

    select (
        

    cast('1990-01-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2030-01-01' as date)

)

select * from filtered


),

final as (
    select 
        cast(date_day as date) as date_day,
        cast(date_trunc('week', date_day) as date) as date_week,
        cast(date_trunc('month', date_day) as date) as date_month,
        cast(date_trunc('quarter', date_day) as date) as date_quarter,
        cast(date_trunc('year', date_day) as date) as date_year
    from days
)

select * from final
  );
  
[0m12:57:28.985635 [debug] [Thread-1  ]: SQL status: SELECT 14610 in 0 seconds
[0m12:57:28.989940 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:57:28.990085 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */
alter table "test_dbt"."public"."dbt_metrics_default_calendar" rename to "dbt_metrics_default_calendar__dbt_backup"
[0m12:57:28.990453 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m12:57:28.992050 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:57:28.992153 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */
alter table "test_dbt"."public"."dbt_metrics_default_calendar__dbt_tmp" rename to "dbt_metrics_default_calendar"
[0m12:57:28.992556 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m12:57:29.003133 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: COMMIT
[0m12:57:29.003279 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:57:29.003368 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: COMMIT
[0m12:57:29.004300 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m12:57:29.007103 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:57:29.007216 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */
drop table if exists "test_dbt"."public"."dbt_metrics_default_calendar__dbt_backup" cascade
[0m12:57:29.009471 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m12:57:29.010131 [debug] [Thread-1  ]: Timing info for model.metrics.dbt_metrics_default_calendar (execute): 2023-02-21 12:57:28.918411 => 2023-02-21 12:57:29.010102
[0m12:57:29.010245 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: Close
[0m12:57:29.010586 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a244f9d3-a0f3-4f51-9b9f-e381fbc83d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f56dc0>]}
[0m12:57:29.010804 [info ] [Thread-1  ]: 1 of 8 OK created sql table model public.dbt_metrics_default_calendar .......... [[32mSELECT 14610[0m in 0.13s]
[0m12:57:29.011515 [debug] [Thread-1  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m12:57:29.011682 [debug] [Thread-1  ]: Began running node model.test_dbt.my_first_dbt_model
[0m12:57:29.011873 [info ] [Thread-1  ]: 2 of 8 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m12:57:29.012172 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.test_dbt.my_first_dbt_model'
[0m12:57:29.012283 [debug] [Thread-1  ]: Began compiling node model.test_dbt.my_first_dbt_model
[0m12:57:29.013919 [debug] [Thread-1  ]: Writing injected SQL for node "model.test_dbt.my_first_dbt_model"
[0m12:57:29.014308 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_first_dbt_model (compile): 2023-02-21 12:57:29.012355 => 2023-02-21 12:57:29.014272
[0m12:57:29.014421 [debug] [Thread-1  ]: Began executing node model.test_dbt.my_first_dbt_model
[0m12:57:29.016847 [debug] [Thread-1  ]: Writing runtime sql for node "model.test_dbt.my_first_dbt_model"
[0m12:57:29.017162 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:57:29.017249 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: BEGIN
[0m12:57:29.017331 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:57:29.020338 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m12:57:29.020444 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:57:29.020524 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_first_dbt_model"} */

  
    

  create  table "test_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id,'alexey' as name, '1991-01-01' as date_id, 97 score
    union all
    select 1 as id,'alexey' as name, '1991-01-02' as date_id, 66 score
    union all
    select 2 as id,'sergey' as name, '1991-01-03' as date_id, 50 score

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m12:57:29.022552 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m12:57:29.024915 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:57:29.025027 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_first_dbt_model"} */
alter table "test_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m12:57:29.025365 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m12:57:29.026889 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:57:29.026982 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_first_dbt_model"} */
alter table "test_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:57:29.027285 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m12:57:29.028393 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: COMMIT
[0m12:57:29.028497 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:57:29.028578 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: COMMIT
[0m12:57:29.029194 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m12:57:29.030673 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m12:57:29.030783 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_first_dbt_model"} */
drop table if exists "test_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
[0m12:57:29.032162 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m12:57:29.032749 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_first_dbt_model (execute): 2023-02-21 12:57:29.014496 => 2023-02-21 12:57:29.032724
[0m12:57:29.032855 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: Close
[0m12:57:29.033175 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a244f9d3-a0f3-4f51-9b9f-e381fbc83d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f56e20>]}
[0m12:57:29.033363 [info ] [Thread-1  ]: 2 of 8 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 3[0m in 0.02s]
[0m12:57:29.033524 [debug] [Thread-1  ]: Finished running node model.test_dbt.my_first_dbt_model
[0m12:57:29.033862 [debug] [Thread-1  ]: Began running node test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:57:29.034005 [info ] [Thread-1  ]: 3 of 8 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m12:57:29.034275 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710'
[0m12:57:29.034379 [debug] [Thread-1  ]: Began compiling node test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:57:29.040856 [debug] [Thread-1  ]: Writing injected SQL for node "test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:57:29.041301 [debug] [Thread-1  ]: Timing info for test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 2023-02-21 12:57:29.034449 => 2023-02-21 12:57:29.041273
[0m12:57:29.041419 [debug] [Thread-1  ]: Began executing node test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:57:29.048338 [debug] [Thread-1  ]: Writing runtime sql for node "test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:57:29.048847 [debug] [Thread-1  ]: Using postgres connection "test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:57:29.048939 [debug] [Thread-1  ]: On test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m12:57:29.049022 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:57:29.068739 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m12:57:29.068949 [debug] [Thread-1  ]: Using postgres connection "test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:57:29.069037 [debug] [Thread-1  ]: On test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "test_dbt"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m12:57:29.071437 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m12:57:29.072497 [debug] [Thread-1  ]: Timing info for test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 2023-02-21 12:57:29.041490 => 2023-02-21 12:57:29.072463
[0m12:57:29.072626 [debug] [Thread-1  ]: On test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m12:57:29.072908 [debug] [Thread-1  ]: On test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m12:57:29.073263 [info ] [Thread-1  ]: 3 of 8 PASS not_null_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.04s]
[0m12:57:29.073446 [debug] [Thread-1  ]: Finished running node test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:57:29.073595 [debug] [Thread-1  ]: Began running node test.test_dbt.unique_my_first_dbt_model_id.16e066b321
[0m12:57:29.073752 [info ] [Thread-1  ]: 4 of 8 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m12:57:29.074080 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.test_dbt.unique_my_first_dbt_model_id.16e066b321'
[0m12:57:29.074198 [debug] [Thread-1  ]: Began compiling node test.test_dbt.unique_my_first_dbt_model_id.16e066b321
[0m12:57:29.077936 [debug] [Thread-1  ]: Writing injected SQL for node "test.test_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m12:57:29.078442 [debug] [Thread-1  ]: Timing info for test.test_dbt.unique_my_first_dbt_model_id.16e066b321 (compile): 2023-02-21 12:57:29.074273 => 2023-02-21 12:57:29.078414
[0m12:57:29.078562 [debug] [Thread-1  ]: Began executing node test.test_dbt.unique_my_first_dbt_model_id.16e066b321
[0m12:57:29.080714 [debug] [Thread-1  ]: Writing runtime sql for node "test.test_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m12:57:29.081047 [debug] [Thread-1  ]: Using postgres connection "test.test_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m12:57:29.081131 [debug] [Thread-1  ]: On test.test_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m12:57:29.081211 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:57:29.089693 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m12:57:29.089809 [debug] [Thread-1  ]: Using postgres connection "test.test_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m12:57:29.089888 [debug] [Thread-1  ]: On test.test_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "test.test_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "test_dbt"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:57:29.091236 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m12:57:29.091946 [debug] [Thread-1  ]: Timing info for test.test_dbt.unique_my_first_dbt_model_id.16e066b321 (execute): 2023-02-21 12:57:29.078633 => 2023-02-21 12:57:29.091914
[0m12:57:29.092052 [debug] [Thread-1  ]: On test.test_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m12:57:29.092240 [debug] [Thread-1  ]: On test.test_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m12:57:29.092571 [error] [Thread-1  ]: 4 of 8 FAIL 1 unique_my_first_dbt_model_id ..................................... [[31mFAIL 1[0m in 0.02s]
[0m12:57:29.092737 [debug] [Thread-1  ]: Finished running node test.test_dbt.unique_my_first_dbt_model_id.16e066b321
[0m12:57:29.093081 [debug] [Thread-1  ]: Began running node model.test_dbt.metric_test
[0m12:57:29.093212 [info ] [Thread-1  ]: 5 of 8 SKIP relation public.metric_test ........................................ [[33mSKIP[0m]
[0m12:57:29.093349 [debug] [Thread-1  ]: Finished running node model.test_dbt.metric_test
[0m12:57:29.093467 [debug] [Thread-1  ]: Began running node model.test_dbt.my_second_dbt_model
[0m12:57:29.093591 [info ] [Thread-1  ]: 6 of 8 SKIP relation public.my_second_dbt_model ................................ [[33mSKIP[0m]
[0m12:57:29.093720 [debug] [Thread-1  ]: Finished running node model.test_dbt.my_second_dbt_model
[0m12:57:29.093943 [debug] [Thread-1  ]: Began running node test.test_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m12:57:29.094090 [info ] [Thread-1  ]: 7 of 8 SKIP test not_null_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m12:57:29.094249 [debug] [Thread-1  ]: Finished running node test.test_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m12:57:29.094376 [debug] [Thread-1  ]: Began running node test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m12:57:29.094493 [info ] [Thread-1  ]: 8 of 8 SKIP test unique_my_second_dbt_model_id ................................. [[33mSKIP[0m]
[0m12:57:29.094626 [debug] [Thread-1  ]: Finished running node test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m12:57:29.095135 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:57:29.095255 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:29.095349 [debug] [MainThread]: On master: BEGIN
[0m12:57:29.095435 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:57:29.120062 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:57:29.120270 [debug] [MainThread]: On master: COMMIT
[0m12:57:29.120383 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:29.120482 [debug] [MainThread]: On master: COMMIT
[0m12:57:29.120693 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:57:29.120808 [debug] [MainThread]: On master: Close
[0m12:57:29.121118 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:29.121212 [debug] [MainThread]: Connection 'test.test_dbt.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m12:57:29.121347 [info ] [MainThread]: 
[0m12:57:29.121489 [info ] [MainThread]: Finished running 2 table models, 4 tests, 2 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m12:57:29.121798 [debug] [MainThread]: Command end result
[0m12:57:29.127581 [info ] [MainThread]: 
[0m12:57:29.127764 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:57:29.127879 [info ] [MainThread]: 
[0m12:57:29.127994 [error] [MainThread]: [31mFailure in test unique_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m12:57:29.128103 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m12:57:29.128204 [info ] [MainThread]: 
[0m12:57:29.128306 [info ] [MainThread]:   compiled Code at target/compiled/test_dbt/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m12:57:29.128416 [info ] [MainThread]: 
[0m12:57:29.128518 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=4 TOTAL=8
[0m12:57:29.128673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e33f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108830f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f3fa00>]}
[0m12:57:29.128810 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 12:57:37.176137 | 12955ae7-7170-4ecc-91c8-64bee55b273d ==============================
[0m12:57:37.176137 [info ] [MainThread]: Running with dbt=1.4.1
[0m12:57:37.177295 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rom.weinstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m12:57:37.177417 [debug] [MainThread]: Tracking: tracking
[0m12:57:37.193474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118f6f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b41100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b41280>]}
[0m12:57:37.288062 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:57:37.288276 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:57:37.292740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12955ae7-7170-4ecc-91c8-64bee55b273d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f080d0>]}
[0m12:57:37.298312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12955ae7-7170-4ecc-91c8-64bee55b273d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e4cc70>]}
[0m12:57:37.298535 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 515 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 3 metrics
[0m12:57:37.298673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12955ae7-7170-4ecc-91c8-64bee55b273d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e4cb50>]}
[0m12:57:37.299446 [info ] [MainThread]: 
[0m12:57:37.300331 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:57:37.301008 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_dbt_public'
[0m12:57:37.307249 [debug] [ThreadPool]: Using postgres connection "list_test_dbt_public"
[0m12:57:37.307423 [debug] [ThreadPool]: On list_test_dbt_public: BEGIN
[0m12:57:37.307540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:37.323855 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m12:57:37.324061 [debug] [ThreadPool]: Using postgres connection "list_test_dbt_public"
[0m12:57:37.324166 [debug] [ThreadPool]: On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "list_test_dbt_public"} */
select
      'test_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m12:57:37.328322 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m12:57:37.329115 [debug] [ThreadPool]: On list_test_dbt_public: ROLLBACK
[0m12:57:37.329401 [debug] [ThreadPool]: On list_test_dbt_public: Close
[0m12:57:37.332973 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:37.333136 [debug] [MainThread]: On master: BEGIN
[0m12:57:37.333247 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:37.342818 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:57:37.342967 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:37.343074 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:57:37.363910 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m12:57:37.364684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12955ae7-7170-4ecc-91c8-64bee55b273d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f1f340>]}
[0m12:57:37.364899 [debug] [MainThread]: On master: ROLLBACK
[0m12:57:37.365177 [debug] [MainThread]: On master: Close
[0m12:57:37.365509 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:57:37.365781 [info ] [MainThread]: 
[0m12:57:37.368071 [debug] [Thread-1  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m12:57:37.368486 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.metrics.dbt_metrics_default_calendar'
[0m12:57:37.368628 [debug] [Thread-1  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m12:57:37.381563 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:57:37.381803 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: BEGIN
[0m12:57:37.381914 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:57:37.389048 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m12:57:37.389182 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m12:57:37.389275 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 
        ((cast('2030-01-01' as date))::date - (cast('1990-01-01' as date))::date)
    
[0m12:57:37.392315 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m12:57:37.401268 [debug] [Thread-1  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m12:57:37.401800 [debug] [Thread-1  ]: Timing info for model.metrics.dbt_metrics_default_calendar (compile): 2023-02-21 12:57:37.368717 => 2023-02-21 12:57:37.401762
[0m12:57:37.401941 [debug] [Thread-1  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m12:57:37.402056 [debug] [Thread-1  ]: Timing info for model.metrics.dbt_metrics_default_calendar (execute): 2023-02-21 12:57:37.402022 => 2023-02-21 12:57:37.402030
[0m12:57:37.402159 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: ROLLBACK
[0m12:57:37.402514 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: Close
[0m12:57:37.403394 [debug] [Thread-1  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m12:57:37.403558 [debug] [Thread-1  ]: Began running node model.test_dbt.my_first_dbt_model
[0m12:57:37.403935 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.test_dbt.my_first_dbt_model'
[0m12:57:37.404060 [debug] [Thread-1  ]: Began compiling node model.test_dbt.my_first_dbt_model
[0m12:57:37.405651 [debug] [Thread-1  ]: Writing injected SQL for node "model.test_dbt.my_first_dbt_model"
[0m12:57:37.405996 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_first_dbt_model (compile): 2023-02-21 12:57:37.404186 => 2023-02-21 12:57:37.405971
[0m12:57:37.406103 [debug] [Thread-1  ]: Began executing node model.test_dbt.my_first_dbt_model
[0m12:57:37.406190 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_first_dbt_model (execute): 2023-02-21 12:57:37.406172 => 2023-02-21 12:57:37.406176
[0m12:57:37.406471 [debug] [Thread-1  ]: Finished running node model.test_dbt.my_first_dbt_model
[0m12:57:37.406805 [debug] [Thread-1  ]: Began running node model.test_dbt.metric_test
[0m12:57:37.407072 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.test_dbt.metric_test'
[0m12:57:37.407175 [debug] [Thread-1  ]: Began compiling node model.test_dbt.metric_test
[0m12:57:37.518608 [debug] [Thread-1  ]: Writing injected SQL for node "model.test_dbt.metric_test"
[0m12:57:37.519209 [debug] [Thread-1  ]: Timing info for model.test_dbt.metric_test (compile): 2023-02-21 12:57:37.407246 => 2023-02-21 12:57:37.519173
[0m12:57:37.519347 [debug] [Thread-1  ]: Began executing node model.test_dbt.metric_test
[0m12:57:37.519447 [debug] [Thread-1  ]: Timing info for model.test_dbt.metric_test (execute): 2023-02-21 12:57:37.519426 => 2023-02-21 12:57:37.519432
[0m12:57:37.519762 [debug] [Thread-1  ]: Finished running node model.test_dbt.metric_test
[0m12:57:37.519909 [debug] [Thread-1  ]: Began running node model.test_dbt.my_second_dbt_model
[0m12:57:37.520136 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.test_dbt.my_second_dbt_model'
[0m12:57:37.520237 [debug] [Thread-1  ]: Began compiling node model.test_dbt.my_second_dbt_model
[0m12:57:37.521688 [debug] [Thread-1  ]: Writing injected SQL for node "model.test_dbt.my_second_dbt_model"
[0m12:57:37.521984 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_second_dbt_model (compile): 2023-02-21 12:57:37.520305 => 2023-02-21 12:57:37.521962
[0m12:57:37.522087 [debug] [Thread-1  ]: Began executing node model.test_dbt.my_second_dbt_model
[0m12:57:37.522171 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_second_dbt_model (execute): 2023-02-21 12:57:37.522153 => 2023-02-21 12:57:37.522156
[0m12:57:37.522440 [debug] [Thread-1  ]: Finished running node model.test_dbt.my_second_dbt_model
[0m12:57:37.522570 [debug] [Thread-1  ]: Began running node test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:57:37.522778 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710'
[0m12:57:37.522868 [debug] [Thread-1  ]: Began compiling node test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:57:37.529248 [debug] [Thread-1  ]: Writing injected SQL for node "test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:57:37.529665 [debug] [Thread-1  ]: Timing info for test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 2023-02-21 12:57:37.522934 => 2023-02-21 12:57:37.529641
[0m12:57:37.529778 [debug] [Thread-1  ]: Began executing node test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:57:37.529868 [debug] [Thread-1  ]: Timing info for test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 2023-02-21 12:57:37.529849 => 2023-02-21 12:57:37.529853
[0m12:57:37.530140 [debug] [Thread-1  ]: Finished running node test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:57:37.530267 [debug] [Thread-1  ]: Began running node test.test_dbt.unique_my_first_dbt_model_id.16e066b321
[0m12:57:37.530509 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.test_dbt.unique_my_first_dbt_model_id.16e066b321'
[0m12:57:37.530605 [debug] [Thread-1  ]: Began compiling node test.test_dbt.unique_my_first_dbt_model_id.16e066b321
[0m12:57:37.533769 [debug] [Thread-1  ]: Writing injected SQL for node "test.test_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m12:57:37.534068 [debug] [Thread-1  ]: Timing info for test.test_dbt.unique_my_first_dbt_model_id.16e066b321 (compile): 2023-02-21 12:57:37.530669 => 2023-02-21 12:57:37.534047
[0m12:57:37.534176 [debug] [Thread-1  ]: Began executing node test.test_dbt.unique_my_first_dbt_model_id.16e066b321
[0m12:57:37.534267 [debug] [Thread-1  ]: Timing info for test.test_dbt.unique_my_first_dbt_model_id.16e066b321 (execute): 2023-02-21 12:57:37.534248 => 2023-02-21 12:57:37.534251
[0m12:57:37.534537 [debug] [Thread-1  ]: Finished running node test.test_dbt.unique_my_first_dbt_model_id.16e066b321
[0m12:57:37.534663 [debug] [Thread-1  ]: Began running node test.test_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m12:57:37.534895 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.test_dbt.not_null_my_second_dbt_model_id.151b76d778'
[0m12:57:37.534989 [debug] [Thread-1  ]: Began compiling node test.test_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m12:57:37.537063 [debug] [Thread-1  ]: Writing injected SQL for node "test.test_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m12:57:37.537360 [debug] [Thread-1  ]: Timing info for test.test_dbt.not_null_my_second_dbt_model_id.151b76d778 (compile): 2023-02-21 12:57:37.535054 => 2023-02-21 12:57:37.537335
[0m12:57:37.537463 [debug] [Thread-1  ]: Began executing node test.test_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m12:57:37.537548 [debug] [Thread-1  ]: Timing info for test.test_dbt.not_null_my_second_dbt_model_id.151b76d778 (execute): 2023-02-21 12:57:37.537530 => 2023-02-21 12:57:37.537533
[0m12:57:37.537804 [debug] [Thread-1  ]: Finished running node test.test_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m12:57:37.537926 [debug] [Thread-1  ]: Began running node test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m12:57:37.538151 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493'
[0m12:57:37.538244 [debug] [Thread-1  ]: Began compiling node test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m12:57:37.540227 [debug] [Thread-1  ]: Writing injected SQL for node "test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:57:37.540496 [debug] [Thread-1  ]: Timing info for test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493 (compile): 2023-02-21 12:57:37.538308 => 2023-02-21 12:57:37.540473
[0m12:57:37.540600 [debug] [Thread-1  ]: Began executing node test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m12:57:37.540685 [debug] [Thread-1  ]: Timing info for test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493 (execute): 2023-02-21 12:57:37.540668 => 2023-02-21 12:57:37.540671
[0m12:57:37.540943 [debug] [Thread-1  ]: Finished running node test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m12:57:37.541313 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:37.541429 [debug] [MainThread]: Connection 'test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m12:57:37.541686 [debug] [MainThread]: Command end result
[0m12:57:37.546293 [info ] [MainThread]: Done.
[0m12:57:37.546477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b57ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b57760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b57dc0>]}
[0m12:57:37.546606 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 12:57:43.265241 | 9c8ecc0f-5b38-49bd-a798-b72be94ad536 ==============================
[0m12:57:43.265241 [info ] [MainThread]: Running with dbt=1.4.1
[0m12:57:43.266350 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rom.weinstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'write_manifest': False, 'compile': False, 'which': 'parse', 'rpc_method': 'parse', 'indirect_selection': 'eager'}
[0m12:57:43.266467 [debug] [MainThread]: Tracking: tracking
[0m12:57:43.285788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d50a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d19df0>]}
[0m12:57:43.286390 [info ] [MainThread]: Start parsing.
[0m12:57:43.301633 [info ] [MainThread]: Dependencies loaded
[0m12:57:43.332074 [info ] [MainThread]: ManifestLoader created
[0m12:57:43.372042 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:57:43.372242 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:57:43.372336 [info ] [MainThread]: Manifest loaded
[0m12:57:43.373032 [info ] [MainThread]: Manifest checked
[0m12:57:43.373291 [info ] [MainThread]: Flat graph built
[0m12:57:43.373414 [info ] [MainThread]: Manifest finished loading
[0m12:57:43.373833 [info ] [MainThread]: Performance info: target/perf_info.json
[0m12:57:43.373968 [info ] [MainThread]: Done.
[0m12:57:43.374125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a4d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a4d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a4d310>]}
[0m12:57:43.374277 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 13:01:04.677906 | 07a13949-316c-4f4a-8099-72b8fca47142 ==============================
[0m13:01:04.677906 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:01:04.678614 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rom.weinstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'clean', 'indirect_selection': 'eager'}
[0m13:01:04.678712 [debug] [MainThread]: Tracking: tracking
[0m13:01:04.700163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eabb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ecedf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ecee20>]}
[0m13:01:04.784668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eabb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ece040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ece760>]}
[0m13:01:04.784931 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 13:01:11.501438 | 1a82c6e7-ebbb-4533-b442-6939ca5220ae ==============================
[0m13:01:11.501438 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:01:11.502668 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rom.weinstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m13:01:11.502792 [debug] [MainThread]: Tracking: tracking
[0m13:01:11.520824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b02dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b280100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2802b0>]}
[0m13:01:11.521876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b02dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b280100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2802b0>]}
[0m13:01:11.522050 [debug] [MainThread]: Flushing usage events
[0m13:01:12.135936 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 2 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.


============================== 2023-02-21 13:01:16.520277 | 4de0e8f2-f22b-47c6-a79d-fa7adcce66e2 ==============================
[0m13:01:16.520277 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:01:16.521586 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rom.weinstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:01:16.521704 [debug] [MainThread]: Tracking: tracking
[0m13:01:16.543811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e2c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113080100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130802b0>]}
[0m13:01:16.544886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e2c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113080100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130802b0>]}
[0m13:01:16.545058 [debug] [MainThread]: Flushing usage events
[0m13:01:17.188883 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 2 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.


============================== 2023-02-21 13:01:22.109518 | 22e8e519-a2f8-4ea9-9a7a-ed554a4beafa ==============================
[0m13:01:22.109518 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:01:22.110694 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rom.weinstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m13:01:22.110806 [debug] [MainThread]: Tracking: tracking
[0m13:01:22.127226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107162eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d1b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071999d0>]}
[0m13:01:22.128134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107162eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d1b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071999d0>]}
[0m13:01:22.128277 [debug] [MainThread]: Flushing usage events
[0m13:01:22.748818 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 2 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.


============================== 2023-02-21 13:01:32.570571 | 23b1722d-7c34-4e54-96ce-897faba09f47 ==============================
[0m13:01:32.570571 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:01:32.571850 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rom.weinstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'write_manifest': False, 'compile': False, 'which': 'parse', 'rpc_method': 'parse', 'indirect_selection': 'eager'}
[0m13:01:32.571986 [debug] [MainThread]: Tracking: tracking
[0m13:01:32.597312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e3e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e3790>]}
[0m13:01:32.597942 [info ] [MainThread]: Start parsing.
[0m13:01:32.598508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e3070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e3790>]}
[0m13:01:32.598644 [debug] [MainThread]: Flushing usage events
[0m13:01:33.212877 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 2 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.


============================== 2023-02-21 13:01:38.965880 | 9e081525-e1a4-46ad-a51f-51f8d18458c3 ==============================
[0m13:01:38.965880 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:01:38.966646 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rom.weinstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m13:01:38.966749 [debug] [MainThread]: Tracking: tracking
[0m13:01:38.985425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fbd3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fcfe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fcfe80>]}
[0m13:01:38.987375 [debug] [MainThread]: Set downloads directory='/var/folders/p0/bjgxzb6x1px3g0w39nrqfklw0000gp/T/dbt-downloads-iy1k305x'
[0m13:01:38.987757 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:01:39.541681 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:01:39.542537 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/metrics.json
[0m13:01:40.068585 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/metrics.json 200
[0m13:01:40.078635 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:01:40.546342 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:01:40.590097 [info ] [MainThread]: Installing dbt-labs/metrics
[0m13:01:41.828377 [info ] [MainThread]:   Installed from version 1.4.0
[0m13:01:41.828640 [info ] [MainThread]:   Up to date!
[0m13:01:41.828823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9e081525-e1a4-46ad-a51f-51f8d18458c3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a094f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a094fa0>]}
[0m13:01:41.828977 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:01:42.882151 [info ] [MainThread]:   Installed from version 1.0.0
[0m13:01:42.882393 [info ] [MainThread]:   Up to date!
[0m13:01:42.882572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9e081525-e1a4-46ad-a51f-51f8d18458c3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a094f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a094fa0>]}
[0m13:01:42.883487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f19ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fbd3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a094e20>]}
[0m13:01:42.883642 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 13:01:46.118804 | 3627f5d8-6bac-431f-94af-6d3275512c88 ==============================
[0m13:01:46.118804 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:01:46.119990 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rom.weinstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'write_manifest': False, 'compile': False, 'which': 'parse', 'rpc_method': 'parse', 'indirect_selection': 'eager'}
[0m13:01:46.120106 [debug] [MainThread]: Tracking: tracking
[0m13:01:46.142125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11190c8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118d9b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b3ce80>]}
[0m13:01:46.142748 [info ] [MainThread]: Start parsing.
[0m13:01:46.158092 [info ] [MainThread]: Dependencies loaded
[0m13:01:46.159527 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:01:46.159744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3627f5d8-6bac-431f-94af-6d3275512c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118f81f0>]}
[0m13:01:46.159890 [info ] [MainThread]: ManifestLoader created
[0m13:01:46.795687 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m13:01:46.801839 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m13:01:46.803322 [debug] [MainThread]: 1603: static parser failed on example/metric_test.sql
[0m13:01:46.827511 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/metric_test.sql
[0m13:01:46.838165 [debug] [MainThread]: 1603: static parser failed on dbt_metrics_default_calendar.sql
[0m13:01:46.853391 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dbt_metrics_default_calendar.sql
[0m13:01:46.894625 [info ] [MainThread]: Manifest loaded
[0m13:01:46.894912 [info ] [MainThread]: Manifest checked
[0m13:01:46.895164 [info ] [MainThread]: Flat graph built
[0m13:01:46.895286 [info ] [MainThread]: Manifest finished loading
[0m13:01:46.895630 [info ] [MainThread]: Performance info: target/perf_info.json
[0m13:01:46.895739 [info ] [MainThread]: Done.
[0m13:01:46.895875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120ec0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120ec5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120ec130>]}
[0m13:01:46.895998 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 13:01:58.701675 | 0f474a26-d390-4817-baa5-f68ae89d2b13 ==============================
[0m13:01:58.701675 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:01:58.702871 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rom.weinstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m13:01:58.703007 [debug] [MainThread]: Tracking: tracking
[0m13:01:58.727706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235a1eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123610b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235d99d0>]}
[0m13:01:58.813815 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:58.814010 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:58.818520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f474a26-d390-4817-baa5-f68ae89d2b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c090d0>]}
[0m13:01:58.823614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f474a26-d390-4817-baa5-f68ae89d2b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b51bb0>]}
[0m13:01:58.823795 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 515 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 3 metrics
[0m13:01:58.823932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f474a26-d390-4817-baa5-f68ae89d2b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b51a90>]}
[0m13:01:58.824610 [info ] [MainThread]: 
[0m13:01:58.825417 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:01:58.825957 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_dbt_public'
[0m13:01:58.831514 [debug] [ThreadPool]: Using postgres connection "list_test_dbt_public"
[0m13:01:58.831638 [debug] [ThreadPool]: On list_test_dbt_public: BEGIN
[0m13:01:58.831742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:58.886895 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:01:58.887128 [debug] [ThreadPool]: Using postgres connection "list_test_dbt_public"
[0m13:01:58.887247 [debug] [ThreadPool]: On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "list_test_dbt_public"} */
select
      'test_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:01:58.891265 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m13:01:58.892177 [debug] [ThreadPool]: On list_test_dbt_public: ROLLBACK
[0m13:01:58.892949 [debug] [ThreadPool]: On list_test_dbt_public: Close
[0m13:01:58.897000 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:58.897190 [debug] [MainThread]: On master: BEGIN
[0m13:01:58.897311 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:58.902702 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:01:58.902853 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:58.902997 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:01:58.917952 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m13:01:58.918814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f474a26-d390-4817-baa5-f68ae89d2b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123610670>]}
[0m13:01:58.919074 [debug] [MainThread]: On master: ROLLBACK
[0m13:01:58.919443 [debug] [MainThread]: On master: Close
[0m13:01:58.919921 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:01:58.920186 [info ] [MainThread]: 
[0m13:01:58.922717 [debug] [Thread-1  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m13:01:58.923195 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.metrics.dbt_metrics_default_calendar'
[0m13:01:58.923349 [debug] [Thread-1  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m13:01:58.937822 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m13:01:58.938071 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: BEGIN
[0m13:01:58.938180 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:01:58.960052 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m13:01:58.960286 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m13:01:58.960384 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 
        ((cast('2030-01-01' as date))::date - (cast('1990-01-01' as date))::date)
    
[0m13:01:58.961277 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m13:01:58.970648 [debug] [Thread-1  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m13:01:58.971652 [debug] [Thread-1  ]: Timing info for model.metrics.dbt_metrics_default_calendar (compile): 2023-02-21 13:01:58.923440 => 2023-02-21 13:01:58.971593
[0m13:01:58.971843 [debug] [Thread-1  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m13:01:58.971955 [debug] [Thread-1  ]: Timing info for model.metrics.dbt_metrics_default_calendar (execute): 2023-02-21 13:01:58.971929 => 2023-02-21 13:01:58.971937
[0m13:01:58.972066 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: ROLLBACK
[0m13:01:58.972503 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: Close
[0m13:01:58.973437 [debug] [Thread-1  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m13:01:58.973616 [debug] [Thread-1  ]: Began running node model.test_dbt.my_first_dbt_model
[0m13:01:58.974088 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.test_dbt.my_first_dbt_model'
[0m13:01:58.974236 [debug] [Thread-1  ]: Began compiling node model.test_dbt.my_first_dbt_model
[0m13:01:58.975970 [debug] [Thread-1  ]: Writing injected SQL for node "model.test_dbt.my_first_dbt_model"
[0m13:01:58.976803 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_first_dbt_model (compile): 2023-02-21 13:01:58.974317 => 2023-02-21 13:01:58.976765
[0m13:01:58.976930 [debug] [Thread-1  ]: Began executing node model.test_dbt.my_first_dbt_model
[0m13:01:58.977028 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_first_dbt_model (execute): 2023-02-21 13:01:58.977006 => 2023-02-21 13:01:58.977012
[0m13:01:58.977328 [debug] [Thread-1  ]: Finished running node model.test_dbt.my_first_dbt_model
[0m13:01:58.977659 [debug] [Thread-1  ]: Began running node model.test_dbt.metric_test
[0m13:01:58.977907 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.test_dbt.metric_test'
[0m13:01:58.978009 [debug] [Thread-1  ]: Began compiling node model.test_dbt.metric_test
[0m13:01:59.091307 [debug] [Thread-1  ]: Writing injected SQL for node "model.test_dbt.metric_test"
[0m13:01:59.091883 [debug] [Thread-1  ]: Timing info for model.test_dbt.metric_test (compile): 2023-02-21 13:01:58.978081 => 2023-02-21 13:01:59.091849
[0m13:01:59.092029 [debug] [Thread-1  ]: Began executing node model.test_dbt.metric_test
[0m13:01:59.092132 [debug] [Thread-1  ]: Timing info for model.test_dbt.metric_test (execute): 2023-02-21 13:01:59.092110 => 2023-02-21 13:01:59.092117
[0m13:01:59.092460 [debug] [Thread-1  ]: Finished running node model.test_dbt.metric_test
[0m13:01:59.092609 [debug] [Thread-1  ]: Began running node model.test_dbt.my_second_dbt_model
[0m13:01:59.092838 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.test_dbt.my_second_dbt_model'
[0m13:01:59.092945 [debug] [Thread-1  ]: Began compiling node model.test_dbt.my_second_dbt_model
[0m13:01:59.094455 [debug] [Thread-1  ]: Writing injected SQL for node "model.test_dbt.my_second_dbt_model"
[0m13:01:59.094754 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_second_dbt_model (compile): 2023-02-21 13:01:59.093012 => 2023-02-21 13:01:59.094735
[0m13:01:59.094856 [debug] [Thread-1  ]: Began executing node model.test_dbt.my_second_dbt_model
[0m13:01:59.094938 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_second_dbt_model (execute): 2023-02-21 13:01:59.094921 => 2023-02-21 13:01:59.094925
[0m13:01:59.095205 [debug] [Thread-1  ]: Finished running node model.test_dbt.my_second_dbt_model
[0m13:01:59.095337 [debug] [Thread-1  ]: Began running node test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:01:59.095549 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710'
[0m13:01:59.095642 [debug] [Thread-1  ]: Began compiling node test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:01:59.102287 [debug] [Thread-1  ]: Writing injected SQL for node "test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:01:59.102867 [debug] [Thread-1  ]: Timing info for test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 2023-02-21 13:01:59.095707 => 2023-02-21 13:01:59.102835
[0m13:01:59.103007 [debug] [Thread-1  ]: Began executing node test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:01:59.103109 [debug] [Thread-1  ]: Timing info for test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 2023-02-21 13:01:59.103087 => 2023-02-21 13:01:59.103092
[0m13:01:59.103426 [debug] [Thread-1  ]: Finished running node test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:01:59.103568 [debug] [Thread-1  ]: Began running node test.test_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:01:59.103880 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.test_dbt.unique_my_first_dbt_model_id.16e066b321'
[0m13:01:59.104007 [debug] [Thread-1  ]: Began compiling node test.test_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:01:59.107574 [debug] [Thread-1  ]: Writing injected SQL for node "test.test_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m13:01:59.107927 [debug] [Thread-1  ]: Timing info for test.test_dbt.unique_my_first_dbt_model_id.16e066b321 (compile): 2023-02-21 13:01:59.104085 => 2023-02-21 13:01:59.107901
[0m13:01:59.108045 [debug] [Thread-1  ]: Began executing node test.test_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:01:59.108136 [debug] [Thread-1  ]: Timing info for test.test_dbt.unique_my_first_dbt_model_id.16e066b321 (execute): 2023-02-21 13:01:59.108117 => 2023-02-21 13:01:59.108121
[0m13:01:59.108409 [debug] [Thread-1  ]: Finished running node test.test_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:01:59.108535 [debug] [Thread-1  ]: Began running node test.test_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:01:59.108777 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.test_dbt.not_null_my_second_dbt_model_id.151b76d778'
[0m13:01:59.108871 [debug] [Thread-1  ]: Began compiling node test.test_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:01:59.111011 [debug] [Thread-1  ]: Writing injected SQL for node "test.test_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m13:01:59.111291 [debug] [Thread-1  ]: Timing info for test.test_dbt.not_null_my_second_dbt_model_id.151b76d778 (compile): 2023-02-21 13:01:59.108936 => 2023-02-21 13:01:59.111263
[0m13:01:59.111392 [debug] [Thread-1  ]: Began executing node test.test_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:01:59.111476 [debug] [Thread-1  ]: Timing info for test.test_dbt.not_null_my_second_dbt_model_id.151b76d778 (execute): 2023-02-21 13:01:59.111457 => 2023-02-21 13:01:59.111461
[0m13:01:59.111738 [debug] [Thread-1  ]: Finished running node test.test_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:01:59.111861 [debug] [Thread-1  ]: Began running node test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:01:59.112091 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493'
[0m13:01:59.112185 [debug] [Thread-1  ]: Began compiling node test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:01:59.114227 [debug] [Thread-1  ]: Writing injected SQL for node "test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:01:59.114480 [debug] [Thread-1  ]: Timing info for test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493 (compile): 2023-02-21 13:01:59.112247 => 2023-02-21 13:01:59.114461
[0m13:01:59.114582 [debug] [Thread-1  ]: Began executing node test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:01:59.114665 [debug] [Thread-1  ]: Timing info for test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493 (execute): 2023-02-21 13:01:59.114647 => 2023-02-21 13:01:59.114651
[0m13:01:59.114924 [debug] [Thread-1  ]: Finished running node test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:01:59.115316 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:59.115402 [debug] [MainThread]: Connection 'test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m13:01:59.115645 [debug] [MainThread]: Command end result
[0m13:01:59.120235 [info ] [MainThread]: Done.
[0m13:01:59.120445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123d094c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123d990d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123cbddf0>]}
[0m13:01:59.120580 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 13:02:03.040428 | 4b7e2ea1-ce1d-40ac-a783-865ca694267f ==============================
[0m13:02:03.040428 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:02:03.041608 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rom.weinstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'write_manifest': False, 'compile': False, 'which': 'parse', 'rpc_method': 'parse', 'indirect_selection': 'eager'}
[0m13:02:03.041726 [debug] [MainThread]: Tracking: tracking
[0m13:02:03.060035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cec250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11303f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11303f370>]}
[0m13:02:03.060696 [info ] [MainThread]: Start parsing.
[0m13:02:03.075770 [info ] [MainThread]: Dependencies loaded
[0m13:02:03.106587 [info ] [MainThread]: ManifestLoader created
[0m13:02:03.150069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:02:03.150261 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:02:03.150357 [info ] [MainThread]: Manifest loaded
[0m13:02:03.151055 [info ] [MainThread]: Manifest checked
[0m13:02:03.151336 [info ] [MainThread]: Flat graph built
[0m13:02:03.151455 [info ] [MainThread]: Manifest finished loading
[0m13:02:03.151897 [info ] [MainThread]: Performance info: target/perf_info.json
[0m13:02:03.152007 [info ] [MainThread]: Done.
[0m13:02:03.152148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131f7520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131f7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131f7490>]}
[0m13:02:03.152284 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 13:02:19.655208 | c563ddfa-57f5-4d70-97d7-35e52efd64cb ==============================
[0m13:02:19.655208 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:02:19.656555 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rom.weinstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m13:02:19.656669 [debug] [MainThread]: Tracking: tracking
[0m13:02:19.673861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b6520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107301100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107301280>]}
[0m13:02:19.763610 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:02:19.763815 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:02:19.768452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c563ddfa-57f5-4d70-97d7-35e52efd64cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c80d0>]}
[0m13:02:19.773894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c563ddfa-57f5-4d70-97d7-35e52efd64cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107611ca0>]}
[0m13:02:19.774076 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 515 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 3 metrics
[0m13:02:19.774213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c563ddfa-57f5-4d70-97d7-35e52efd64cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107611b80>]}
[0m13:02:19.774933 [info ] [MainThread]: 
[0m13:02:19.775718 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:02:19.776232 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_dbt_public'
[0m13:02:19.781723 [debug] [ThreadPool]: Using postgres connection "list_test_dbt_public"
[0m13:02:19.781884 [debug] [ThreadPool]: On list_test_dbt_public: BEGIN
[0m13:02:19.782006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:19.823346 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:02:19.823583 [debug] [ThreadPool]: Using postgres connection "list_test_dbt_public"
[0m13:02:19.823695 [debug] [ThreadPool]: On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "list_test_dbt_public"} */
select
      'test_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:02:19.833376 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m13:02:19.834229 [debug] [ThreadPool]: On list_test_dbt_public: ROLLBACK
[0m13:02:19.834558 [debug] [ThreadPool]: On list_test_dbt_public: Close
[0m13:02:19.838424 [debug] [MainThread]: Using postgres connection "master"
[0m13:02:19.838576 [debug] [MainThread]: On master: BEGIN
[0m13:02:19.838695 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:02:19.846949 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:02:19.847092 [debug] [MainThread]: Using postgres connection "master"
[0m13:02:19.847200 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:02:19.866923 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m13:02:19.867651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c563ddfa-57f5-4d70-97d7-35e52efd64cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b6730>]}
[0m13:02:19.867862 [debug] [MainThread]: On master: ROLLBACK
[0m13:02:19.868156 [debug] [MainThread]: On master: Close
[0m13:02:19.868495 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:02:19.868650 [info ] [MainThread]: 
[0m13:02:19.870921 [debug] [Thread-1  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m13:02:19.871279 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.metrics.dbt_metrics_default_calendar'
[0m13:02:19.871418 [debug] [Thread-1  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m13:02:19.885023 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m13:02:19.885196 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: BEGIN
[0m13:02:19.885296 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:02:19.894255 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m13:02:19.894376 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m13:02:19.894465 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 
        ((cast('2030-01-01' as date))::date - (cast('1990-01-01' as date))::date)
    
[0m13:02:19.899401 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m13:02:19.908746 [debug] [Thread-1  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m13:02:19.909248 [debug] [Thread-1  ]: Timing info for model.metrics.dbt_metrics_default_calendar (compile): 2023-02-21 13:02:19.871509 => 2023-02-21 13:02:19.909209
[0m13:02:19.909399 [debug] [Thread-1  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m13:02:19.909511 [debug] [Thread-1  ]: Timing info for model.metrics.dbt_metrics_default_calendar (execute): 2023-02-21 13:02:19.909484 => 2023-02-21 13:02:19.909493
[0m13:02:19.909612 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: ROLLBACK
[0m13:02:19.909981 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: Close
[0m13:02:19.910886 [debug] [Thread-1  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m13:02:19.911051 [debug] [Thread-1  ]: Began running node model.test_dbt.my_first_dbt_model
[0m13:02:19.911491 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.test_dbt.my_first_dbt_model'
[0m13:02:19.911630 [debug] [Thread-1  ]: Began compiling node model.test_dbt.my_first_dbt_model
[0m13:02:19.913443 [debug] [Thread-1  ]: Writing injected SQL for node "model.test_dbt.my_first_dbt_model"
[0m13:02:19.913956 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_first_dbt_model (compile): 2023-02-21 13:02:19.911714 => 2023-02-21 13:02:19.913918
[0m13:02:19.914111 [debug] [Thread-1  ]: Began executing node model.test_dbt.my_first_dbt_model
[0m13:02:19.914210 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_first_dbt_model (execute): 2023-02-21 13:02:19.914190 => 2023-02-21 13:02:19.914194
[0m13:02:19.914531 [debug] [Thread-1  ]: Finished running node model.test_dbt.my_first_dbt_model
[0m13:02:19.914866 [debug] [Thread-1  ]: Began running node model.test_dbt.metric_test
[0m13:02:19.915133 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.test_dbt.metric_test'
[0m13:02:19.915261 [debug] [Thread-1  ]: Began compiling node model.test_dbt.metric_test
[0m13:02:20.029933 [debug] [Thread-1  ]: Writing injected SQL for node "model.test_dbt.metric_test"
[0m13:02:20.030533 [debug] [Thread-1  ]: Timing info for model.test_dbt.metric_test (compile): 2023-02-21 13:02:19.915341 => 2023-02-21 13:02:20.030493
[0m13:02:20.030685 [debug] [Thread-1  ]: Began executing node model.test_dbt.metric_test
[0m13:02:20.030790 [debug] [Thread-1  ]: Timing info for model.test_dbt.metric_test (execute): 2023-02-21 13:02:20.030767 => 2023-02-21 13:02:20.030774
[0m13:02:20.031120 [debug] [Thread-1  ]: Finished running node model.test_dbt.metric_test
[0m13:02:20.031265 [debug] [Thread-1  ]: Began running node model.test_dbt.my_second_dbt_model
[0m13:02:20.031492 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.test_dbt.my_second_dbt_model'
[0m13:02:20.031591 [debug] [Thread-1  ]: Began compiling node model.test_dbt.my_second_dbt_model
[0m13:02:20.033103 [debug] [Thread-1  ]: Writing injected SQL for node "model.test_dbt.my_second_dbt_model"
[0m13:02:20.033402 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_second_dbt_model (compile): 2023-02-21 13:02:20.031658 => 2023-02-21 13:02:20.033380
[0m13:02:20.033507 [debug] [Thread-1  ]: Began executing node model.test_dbt.my_second_dbt_model
[0m13:02:20.033593 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_second_dbt_model (execute): 2023-02-21 13:02:20.033575 => 2023-02-21 13:02:20.033579
[0m13:02:20.033871 [debug] [Thread-1  ]: Finished running node model.test_dbt.my_second_dbt_model
[0m13:02:20.034003 [debug] [Thread-1  ]: Began running node test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:02:20.034220 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710'
[0m13:02:20.034313 [debug] [Thread-1  ]: Began compiling node test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:02:20.040819 [debug] [Thread-1  ]: Writing injected SQL for node "test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:02:20.041180 [debug] [Thread-1  ]: Timing info for test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 2023-02-21 13:02:20.034379 => 2023-02-21 13:02:20.041157
[0m13:02:20.041293 [debug] [Thread-1  ]: Began executing node test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:02:20.041385 [debug] [Thread-1  ]: Timing info for test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 2023-02-21 13:02:20.041366 => 2023-02-21 13:02:20.041370
[0m13:02:20.041663 [debug] [Thread-1  ]: Finished running node test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:02:20.041792 [debug] [Thread-1  ]: Began running node test.test_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:02:20.042030 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.test_dbt.unique_my_first_dbt_model_id.16e066b321'
[0m13:02:20.042126 [debug] [Thread-1  ]: Began compiling node test.test_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:02:20.045372 [debug] [Thread-1  ]: Writing injected SQL for node "test.test_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m13:02:20.045676 [debug] [Thread-1  ]: Timing info for test.test_dbt.unique_my_first_dbt_model_id.16e066b321 (compile): 2023-02-21 13:02:20.042193 => 2023-02-21 13:02:20.045651
[0m13:02:20.045783 [debug] [Thread-1  ]: Began executing node test.test_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:02:20.045872 [debug] [Thread-1  ]: Timing info for test.test_dbt.unique_my_first_dbt_model_id.16e066b321 (execute): 2023-02-21 13:02:20.045853 => 2023-02-21 13:02:20.045857
[0m13:02:20.046155 [debug] [Thread-1  ]: Finished running node test.test_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:02:20.046288 [debug] [Thread-1  ]: Began running node test.test_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:02:20.046533 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.test_dbt.not_null_my_second_dbt_model_id.151b76d778'
[0m13:02:20.046627 [debug] [Thread-1  ]: Began compiling node test.test_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:02:20.048728 [debug] [Thread-1  ]: Writing injected SQL for node "test.test_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m13:02:20.048994 [debug] [Thread-1  ]: Timing info for test.test_dbt.not_null_my_second_dbt_model_id.151b76d778 (compile): 2023-02-21 13:02:20.046691 => 2023-02-21 13:02:20.048973
[0m13:02:20.049100 [debug] [Thread-1  ]: Began executing node test.test_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:02:20.049187 [debug] [Thread-1  ]: Timing info for test.test_dbt.not_null_my_second_dbt_model_id.151b76d778 (execute): 2023-02-21 13:02:20.049169 => 2023-02-21 13:02:20.049172
[0m13:02:20.049451 [debug] [Thread-1  ]: Finished running node test.test_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:02:20.049576 [debug] [Thread-1  ]: Began running node test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:02:20.049810 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493'
[0m13:02:20.049903 [debug] [Thread-1  ]: Began compiling node test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:02:20.051930 [debug] [Thread-1  ]: Writing injected SQL for node "test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:02:20.052211 [debug] [Thread-1  ]: Timing info for test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493 (compile): 2023-02-21 13:02:20.049966 => 2023-02-21 13:02:20.052192
[0m13:02:20.052315 [debug] [Thread-1  ]: Began executing node test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:02:20.052403 [debug] [Thread-1  ]: Timing info for test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493 (execute): 2023-02-21 13:02:20.052385 => 2023-02-21 13:02:20.052389
[0m13:02:20.052664 [debug] [Thread-1  ]: Finished running node test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:02:20.053044 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:02:20.053158 [debug] [MainThread]: Connection 'test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m13:02:20.053411 [debug] [MainThread]: Command end result
[0m13:02:20.058125 [info ] [MainThread]: Done.
[0m13:02:20.058364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107611910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107611070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076117f0>]}
[0m13:02:20.058507 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 13:12:24.899914 | 5fc34214-1a6d-4161-bc02-134eca76d0bf ==============================
[0m13:12:24.899914 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:12:24.901381 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rom.weinstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:12:24.901513 [debug] [MainThread]: Tracking: tracking
[0m13:12:24.917781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141a2eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114211b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141d99d0>]}
[0m13:12:25.011461 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:12:25.011665 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:12:25.016146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fc34214-1a6d-4161-bc02-134eca76d0bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11480a0d0>]}
[0m13:12:25.021441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fc34214-1a6d-4161-bc02-134eca76d0bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11474fbb0>]}
[0m13:12:25.021625 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 515 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 3 metrics
[0m13:12:25.021759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fc34214-1a6d-4161-bc02-134eca76d0bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11474fa90>]}
[0m13:12:25.022434 [info ] [MainThread]: 
[0m13:12:25.023213 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:12:25.023756 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_dbt'
[0m13:12:25.029605 [debug] [ThreadPool]: Using postgres connection "list_test_dbt"
[0m13:12:25.029781 [debug] [ThreadPool]: On list_test_dbt: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "list_test_dbt"} */

    select distinct nspname from pg_namespace
  
[0m13:12:25.029887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:25.090166 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m13:12:25.091206 [debug] [ThreadPool]: On list_test_dbt: Close
[0m13:12:25.092519 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_dbt_public'
[0m13:12:25.096911 [debug] [ThreadPool]: Using postgres connection "list_test_dbt_public"
[0m13:12:25.097132 [debug] [ThreadPool]: On list_test_dbt_public: BEGIN
[0m13:12:25.097278 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:12:25.134396 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:12:25.134654 [debug] [ThreadPool]: Using postgres connection "list_test_dbt_public"
[0m13:12:25.134784 [debug] [ThreadPool]: On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "list_test_dbt_public"} */
select
      'test_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:12:25.142318 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m13:12:25.143286 [debug] [ThreadPool]: On list_test_dbt_public: ROLLBACK
[0m13:12:25.143592 [debug] [ThreadPool]: On list_test_dbt_public: Close
[0m13:12:25.148061 [debug] [MainThread]: Using postgres connection "master"
[0m13:12:25.148305 [debug] [MainThread]: On master: BEGIN
[0m13:12:25.148446 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:12:25.153830 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:12:25.154038 [debug] [MainThread]: Using postgres connection "master"
[0m13:12:25.154176 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:12:25.160474 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m13:12:25.161339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fc34214-1a6d-4161-bc02-134eca76d0bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114467a30>]}
[0m13:12:25.161615 [debug] [MainThread]: On master: ROLLBACK
[0m13:12:25.161908 [debug] [MainThread]: Using postgres connection "master"
[0m13:12:25.162051 [debug] [MainThread]: On master: BEGIN
[0m13:12:25.162407 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:12:25.162546 [debug] [MainThread]: On master: COMMIT
[0m13:12:25.162669 [debug] [MainThread]: Using postgres connection "master"
[0m13:12:25.162786 [debug] [MainThread]: On master: COMMIT
[0m13:12:25.163014 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:12:25.163153 [debug] [MainThread]: On master: Close
[0m13:12:25.163522 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:12:25.163685 [info ] [MainThread]: 
[0m13:12:25.165731 [debug] [Thread-1  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m13:12:25.165950 [info ] [Thread-1  ]: 1 of 4 START sql table model public.dbt_metrics_default_calendar ............... [RUN]
[0m13:12:25.166339 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.metrics.dbt_metrics_default_calendar'
[0m13:12:25.166477 [debug] [Thread-1  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m13:12:25.180796 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m13:12:25.180955 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: BEGIN
[0m13:12:25.181062 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:12:25.204959 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m13:12:25.205186 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m13:12:25.205294 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 
        ((cast('2030-01-01' as date))::date - (cast('1990-01-01' as date))::date)
    
[0m13:12:25.205849 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m13:12:25.215647 [debug] [Thread-1  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m13:12:25.216212 [debug] [Thread-1  ]: Timing info for model.metrics.dbt_metrics_default_calendar (compile): 2023-02-21 13:12:25.166571 => 2023-02-21 13:12:25.216169
[0m13:12:25.216366 [debug] [Thread-1  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m13:12:25.237262 [debug] [Thread-1  ]: Writing runtime sql for node "model.metrics.dbt_metrics_default_calendar"
[0m13:12:25.237917 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m13:12:25.238027 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */

  
    

  create  table "test_dbt"."public"."dbt_metrics_default_calendar__dbt_tmp"
  as (
    

with days as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
    
    

    )

    select *
    from unioned
    where generated_number <= 14610
    order by generated_number



),

all_periods as (

    select (
        

    cast('1990-01-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2030-01-01' as date)

)

select * from filtered


),

final as (
    select 
        cast(date_day as date) as date_day,
        cast(date_trunc('week', date_day) as date) as date_week,
        cast(date_trunc('month', date_day) as date) as date_month,
        cast(date_trunc('quarter', date_day) as date) as date_quarter,
        cast(date_trunc('year', date_day) as date) as date_year
    from days
)

select * from final
  );
  
[0m13:12:25.308742 [debug] [Thread-1  ]: SQL status: SELECT 14610 in 0 seconds
[0m13:12:25.313426 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m13:12:25.313610 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */
alter table "test_dbt"."public"."dbt_metrics_default_calendar" rename to "dbt_metrics_default_calendar__dbt_backup"
[0m13:12:25.314137 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m13:12:25.316057 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m13:12:25.316189 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */
alter table "test_dbt"."public"."dbt_metrics_default_calendar__dbt_tmp" rename to "dbt_metrics_default_calendar"
[0m13:12:25.316694 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m13:12:25.327961 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: COMMIT
[0m13:12:25.328138 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m13:12:25.328234 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: COMMIT
[0m13:12:25.329282 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m13:12:25.332101 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m13:12:25.332225 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */
drop table if exists "test_dbt"."public"."dbt_metrics_default_calendar__dbt_backup" cascade
[0m13:12:25.334100 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m13:12:25.334813 [debug] [Thread-1  ]: Timing info for model.metrics.dbt_metrics_default_calendar (execute): 2023-02-21 13:12:25.216447 => 2023-02-21 13:12:25.334785
[0m13:12:25.334937 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: Close
[0m13:12:25.335284 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc34214-1a6d-4161-bc02-134eca76d0bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a2cc10>]}
[0m13:12:25.335502 [info ] [Thread-1  ]: 1 of 4 OK created sql table model public.dbt_metrics_default_calendar .......... [[32mSELECT 14610[0m in 0.17s]
[0m13:12:25.336234 [debug] [Thread-1  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m13:12:25.336405 [debug] [Thread-1  ]: Began running node model.test_dbt.my_first_dbt_model
[0m13:12:25.336618 [info ] [Thread-1  ]: 2 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m13:12:25.336961 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.test_dbt.my_first_dbt_model'
[0m13:12:25.337084 [debug] [Thread-1  ]: Began compiling node model.test_dbt.my_first_dbt_model
[0m13:12:25.338927 [debug] [Thread-1  ]: Writing injected SQL for node "model.test_dbt.my_first_dbt_model"
[0m13:12:25.339386 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_first_dbt_model (compile): 2023-02-21 13:12:25.337161 => 2023-02-21 13:12:25.339349
[0m13:12:25.339527 [debug] [Thread-1  ]: Began executing node model.test_dbt.my_first_dbt_model
[0m13:12:25.341889 [debug] [Thread-1  ]: Writing runtime sql for node "model.test_dbt.my_first_dbt_model"
[0m13:12:25.342632 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m13:12:25.342777 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: BEGIN
[0m13:12:25.342869 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:12:25.346906 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m13:12:25.347046 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m13:12:25.347132 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_first_dbt_model"} */

  
    

  create  table "test_dbt"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id,'alexey' as name, '1991-01-01' as date_id, 97 score
    union all
    select 1 as id,'alexey' as name, '1991-01-02' as date_id, 66 score
    union all
    select 2 as id,'sergey' as name, '1991-01-03' as date_id, 50 score

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m13:12:25.349834 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m13:12:25.352535 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m13:12:25.352760 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_first_dbt_model"} */
alter table "test_dbt"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m13:12:25.353144 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m13:12:25.354833 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m13:12:25.354951 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_first_dbt_model"} */
alter table "test_dbt"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:12:25.355328 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m13:12:25.356501 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: COMMIT
[0m13:12:25.356608 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m13:12:25.356690 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: COMMIT
[0m13:12:25.357410 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m13:12:25.358954 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_first_dbt_model"
[0m13:12:25.359057 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_first_dbt_model"} */
drop table if exists "test_dbt"."public"."my_first_dbt_model__dbt_backup" cascade
[0m13:12:25.364532 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m13:12:25.365291 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_first_dbt_model (execute): 2023-02-21 13:12:25.339605 => 2023-02-21 13:12:25.365262
[0m13:12:25.365428 [debug] [Thread-1  ]: On model.test_dbt.my_first_dbt_model: Close
[0m13:12:25.365885 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc34214-1a6d-4161-bc02-134eca76d0bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a2ca30>]}
[0m13:12:25.366128 [info ] [Thread-1  ]: 2 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 3[0m in 0.03s]
[0m13:12:25.366316 [debug] [Thread-1  ]: Finished running node model.test_dbt.my_first_dbt_model
[0m13:12:25.366747 [debug] [Thread-1  ]: Began running node model.test_dbt.metric_test
[0m13:12:25.366989 [info ] [Thread-1  ]: 3 of 4 START sql view model public.metric_test ................................. [RUN]
[0m13:12:25.367313 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.test_dbt.metric_test'
[0m13:12:25.367424 [debug] [Thread-1  ]: Began compiling node model.test_dbt.metric_test
[0m13:12:25.486881 [debug] [Thread-1  ]: Writing injected SQL for node "model.test_dbt.metric_test"
[0m13:12:25.487424 [debug] [Thread-1  ]: Timing info for model.test_dbt.metric_test (compile): 2023-02-21 13:12:25.367496 => 2023-02-21 13:12:25.487384
[0m13:12:25.487560 [debug] [Thread-1  ]: Began executing node model.test_dbt.metric_test
[0m13:12:25.497648 [debug] [Thread-1  ]: Writing runtime sql for node "model.test_dbt.metric_test"
[0m13:12:25.498216 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.metric_test"
[0m13:12:25.498395 [debug] [Thread-1  ]: On model.test_dbt.metric_test: BEGIN
[0m13:12:25.498494 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:12:25.503740 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m13:12:25.503893 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.metric_test"
[0m13:12:25.503983 [debug] [Thread-1  ]: On model.test_dbt.metric_test: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.metric_test"} */

  create view "test_dbt"."public"."metric_test__dbt_tmp" as (
    select *,

    now() + ((interval '1 ') * (1))


from -- depends on: "test_dbt"."public"."dbt_metrics_default_calendar"

(

with calendar as (
    select 
        * 
    from "test_dbt"."public"."dbt_metrics_default_calendar"
     
)

, model_51758de9e889a72967b82e35fea7902f__aggregate as (
    
    select
        date_week,
        name,
        bool_or(metric_date_day is not null) as has_data,
        sum(property_to_aggregate__rolling_new_customers) as rolling_new_customers,
        max(property_to_aggregate__test_update) as test_update
    from (
        select 
            cast(base_model.date_id as date) as metric_date_day,
            calendar.date_week as date_week,
            calendar.date_day as window_filter_date,
            base_model.name,
            (score) as property_to_aggregate__rolling_new_customers,
            (score) as property_to_aggregate__test_update
        from "test_dbt"."public"."my_first_dbt_model" base_model 
        
        left join calendar
            on cast(base_model.date_id as date) = calendar.date_day
        
        where 1=1
        
    ) as base_query

    where 1=1
    group by 1, 2

), model_51758de9e889a72967b82e35fea7902f__final as (
    
    select
        parent_metric_cte.date_week,
        parent_metric_cte.name,
        coalesce(rolling_new_customers, 0) as rolling_new_customers,
        coalesce(test_update, 0) as test_update
    from model_51758de9e889a72967b82e35fea7902f__aggregate as parent_metric_cte
)

select
    date_week ,
    name,
    rolling_new_customers,
    test_update  
    
from model_51758de9e889a72967b82e35fea7902f__final
    
order by 1 desc
    
) metric_subq
  );
[0m13:12:25.512014 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m13:12:25.514004 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.metric_test"
[0m13:12:25.514146 [debug] [Thread-1  ]: On model.test_dbt.metric_test: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.metric_test"} */
alter table "test_dbt"."public"."metric_test__dbt_tmp" rename to "metric_test"
[0m13:12:25.515610 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m13:12:25.516579 [debug] [Thread-1  ]: On model.test_dbt.metric_test: COMMIT
[0m13:12:25.516702 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.metric_test"
[0m13:12:25.516789 [debug] [Thread-1  ]: On model.test_dbt.metric_test: COMMIT
[0m13:12:25.517790 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m13:12:25.519326 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.metric_test"
[0m13:12:25.519454 [debug] [Thread-1  ]: On model.test_dbt.metric_test: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.metric_test"} */
drop view if exists "test_dbt"."public"."metric_test__dbt_backup" cascade
[0m13:12:25.519785 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m13:12:25.520384 [debug] [Thread-1  ]: Timing info for model.test_dbt.metric_test (execute): 2023-02-21 13:12:25.487639 => 2023-02-21 13:12:25.520354
[0m13:12:25.520493 [debug] [Thread-1  ]: On model.test_dbt.metric_test: Close
[0m13:12:25.520835 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc34214-1a6d-4161-bc02-134eca76d0bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148e2d90>]}
[0m13:12:25.521038 [info ] [Thread-1  ]: 3 of 4 OK created sql view model public.metric_test ............................ [[32mCREATE VIEW[0m in 0.15s]
[0m13:12:25.521214 [debug] [Thread-1  ]: Finished running node model.test_dbt.metric_test
[0m13:12:25.521359 [debug] [Thread-1  ]: Began running node model.test_dbt.my_second_dbt_model
[0m13:12:25.521532 [info ] [Thread-1  ]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m13:12:25.521816 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.test_dbt.my_second_dbt_model'
[0m13:12:25.521924 [debug] [Thread-1  ]: Began compiling node model.test_dbt.my_second_dbt_model
[0m13:12:25.524311 [debug] [Thread-1  ]: Writing injected SQL for node "model.test_dbt.my_second_dbt_model"
[0m13:12:25.524749 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_second_dbt_model (compile): 2023-02-21 13:12:25.522003 => 2023-02-21 13:12:25.524718
[0m13:12:25.524871 [debug] [Thread-1  ]: Began executing node model.test_dbt.my_second_dbt_model
[0m13:12:25.527082 [debug] [Thread-1  ]: Writing runtime sql for node "model.test_dbt.my_second_dbt_model"
[0m13:12:25.527356 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_second_dbt_model"
[0m13:12:25.527445 [debug] [Thread-1  ]: On model.test_dbt.my_second_dbt_model: BEGIN
[0m13:12:25.527528 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:12:25.536666 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m13:12:25.536852 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_second_dbt_model"
[0m13:12:25.536938 [debug] [Thread-1  ]: On model.test_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_second_dbt_model"} */

  create view "test_dbt"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "test_dbt"."public"."my_first_dbt_model"
where id = 1
  );
[0m13:12:25.542431 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m13:12:25.544205 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_second_dbt_model"
[0m13:12:25.544300 [debug] [Thread-1  ]: On model.test_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_second_dbt_model"} */
alter table "test_dbt"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:12:25.549846 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m13:12:25.550822 [debug] [Thread-1  ]: On model.test_dbt.my_second_dbt_model: COMMIT
[0m13:12:25.550941 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_second_dbt_model"
[0m13:12:25.551029 [debug] [Thread-1  ]: On model.test_dbt.my_second_dbt_model: COMMIT
[0m13:12:25.551981 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m13:12:25.553334 [debug] [Thread-1  ]: Using postgres connection "model.test_dbt.my_second_dbt_model"
[0m13:12:25.553428 [debug] [Thread-1  ]: On model.test_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.test_dbt.my_second_dbt_model"} */
drop view if exists "test_dbt"."public"."my_second_dbt_model__dbt_backup" cascade
[0m13:12:25.553737 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m13:12:25.554327 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_second_dbt_model (execute): 2023-02-21 13:12:25.524943 => 2023-02-21 13:12:25.554297
[0m13:12:25.554436 [debug] [Thread-1  ]: On model.test_dbt.my_second_dbt_model: Close
[0m13:12:25.554761 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc34214-1a6d-4161-bc02-134eca76d0bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b6ef10>]}
[0m13:12:25.554968 [info ] [Thread-1  ]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.03s]
[0m13:12:25.555136 [debug] [Thread-1  ]: Finished running node model.test_dbt.my_second_dbt_model
[0m13:12:25.555776 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:12:25.555905 [debug] [MainThread]: Using postgres connection "master"
[0m13:12:25.556155 [debug] [MainThread]: On master: BEGIN
[0m13:12:25.556280 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:12:25.567471 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:12:25.567727 [debug] [MainThread]: On master: COMMIT
[0m13:12:25.567858 [debug] [MainThread]: Using postgres connection "master"
[0m13:12:25.567960 [debug] [MainThread]: On master: COMMIT
[0m13:12:25.568221 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:12:25.568429 [debug] [MainThread]: On master: Close
[0m13:12:25.568777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:12:25.568878 [debug] [MainThread]: Connection 'model.test_dbt.my_second_dbt_model' was properly closed.
[0m13:12:25.569017 [info ] [MainThread]: 
[0m13:12:25.569154 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m13:12:25.569390 [debug] [MainThread]: Command end result
[0m13:12:25.574776 [info ] [MainThread]: 
[0m13:12:25.575026 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:12:25.575156 [info ] [MainThread]: 
[0m13:12:25.575266 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:12:25.575438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b735b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a11e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b6a5e0>]}
[0m13:12:25.575598 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 13:12:35.479083 | fd636aee-4d31-424a-a2ea-3014875ca7f6 ==============================
[0m13:12:35.479083 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:12:35.480451 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rom.weinstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'write_manifest': False, 'compile': False, 'which': 'parse', 'rpc_method': 'parse', 'indirect_selection': 'eager'}
[0m13:12:35.480583 [debug] [MainThread]: Tracking: tracking
[0m13:12:35.500180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cb6760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f01100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f012b0>]}
[0m13:12:35.500866 [info ] [MainThread]: Start parsing.
[0m13:12:35.517444 [info ] [MainThread]: Dependencies loaded
[0m13:12:35.550129 [info ] [MainThread]: ManifestLoader created
[0m13:12:35.594811 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:12:35.595022 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:12:35.595136 [info ] [MainThread]: Manifest loaded
[0m13:12:35.595868 [info ] [MainThread]: Manifest checked
[0m13:12:35.596140 [info ] [MainThread]: Flat graph built
[0m13:12:35.596260 [info ] [MainThread]: Manifest finished loading
[0m13:12:35.596691 [info ] [MainThread]: Performance info: target/perf_info.json
[0m13:12:35.596799 [info ] [MainThread]: Done.
[0m13:12:35.596951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050ac460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050ac3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050ac3d0>]}
[0m13:12:35.597095 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 13:12:43.514302 | dd188b78-8c3b-4909-9e30-1094bcedbb75 ==============================
[0m13:12:43.514302 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:12:43.515526 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/rom.weinstein/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m13:12:43.515645 [debug] [MainThread]: Tracking: tracking
[0m13:12:43.536822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10512d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105151b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051199a0>]}
[0m13:12:43.629185 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:12:43.629392 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:12:43.633765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd188b78-8c3b-4909-9e30-1094bcedbb75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057350d0>]}
[0m13:12:43.639689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd188b78-8c3b-4909-9e30-1094bcedbb75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10567db80>]}
[0m13:12:43.639866 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 515 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 3 metrics
[0m13:12:43.639997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd188b78-8c3b-4909-9e30-1094bcedbb75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10567da60>]}
[0m13:12:43.640670 [info ] [MainThread]: 
[0m13:12:43.641448 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:12:43.641970 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_dbt_public'
[0m13:12:43.647771 [debug] [ThreadPool]: Using postgres connection "list_test_dbt_public"
[0m13:12:43.647941 [debug] [ThreadPool]: On list_test_dbt_public: BEGIN
[0m13:12:43.648046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:43.691552 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:12:43.691795 [debug] [ThreadPool]: Using postgres connection "list_test_dbt_public"
[0m13:12:43.691912 [debug] [ThreadPool]: On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "list_test_dbt_public"} */
select
      'test_dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:12:43.697855 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m13:12:43.698746 [debug] [ThreadPool]: On list_test_dbt_public: ROLLBACK
[0m13:12:43.703153 [debug] [ThreadPool]: On list_test_dbt_public: Close
[0m13:12:43.707156 [debug] [MainThread]: Using postgres connection "master"
[0m13:12:43.707326 [debug] [MainThread]: On master: BEGIN
[0m13:12:43.707445 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:12:43.733320 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:12:43.733505 [debug] [MainThread]: Using postgres connection "master"
[0m13:12:43.733623 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:12:43.741195 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m13:12:43.742184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd188b78-8c3b-4909-9e30-1094bcedbb75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054979a0>]}
[0m13:12:43.742404 [debug] [MainThread]: On master: ROLLBACK
[0m13:12:43.742701 [debug] [MainThread]: On master: Close
[0m13:12:43.743042 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:12:43.743201 [info ] [MainThread]: 
[0m13:12:43.745268 [debug] [Thread-1  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m13:12:43.745657 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.metrics.dbt_metrics_default_calendar'
[0m13:12:43.745811 [debug] [Thread-1  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m13:12:43.760037 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m13:12:43.760230 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: BEGIN
[0m13:12:43.760338 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:12:43.769913 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m13:12:43.770066 [debug] [Thread-1  ]: Using postgres connection "model.metrics.dbt_metrics_default_calendar"
[0m13:12:43.770169 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "test_dbt", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 
        ((cast('2030-01-01' as date))::date - (cast('1990-01-01' as date))::date)
    
[0m13:12:43.770575 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m13:12:43.780202 [debug] [Thread-1  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m13:12:43.780831 [debug] [Thread-1  ]: Timing info for model.metrics.dbt_metrics_default_calendar (compile): 2023-02-21 13:12:43.745911 => 2023-02-21 13:12:43.780769
[0m13:12:43.781042 [debug] [Thread-1  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m13:12:43.781159 [debug] [Thread-1  ]: Timing info for model.metrics.dbt_metrics_default_calendar (execute): 2023-02-21 13:12:43.781132 => 2023-02-21 13:12:43.781141
[0m13:12:43.781273 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: ROLLBACK
[0m13:12:43.782290 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: Close
[0m13:12:43.783321 [debug] [Thread-1  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m13:12:43.783560 [debug] [Thread-1  ]: Began running node model.test_dbt.my_first_dbt_model
[0m13:12:43.784043 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.test_dbt.my_first_dbt_model'
[0m13:12:43.784184 [debug] [Thread-1  ]: Began compiling node model.test_dbt.my_first_dbt_model
[0m13:12:43.785965 [debug] [Thread-1  ]: Writing injected SQL for node "model.test_dbt.my_first_dbt_model"
[0m13:12:43.786356 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_first_dbt_model (compile): 2023-02-21 13:12:43.784269 => 2023-02-21 13:12:43.786325
[0m13:12:43.786488 [debug] [Thread-1  ]: Began executing node model.test_dbt.my_first_dbt_model
[0m13:12:43.786585 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_first_dbt_model (execute): 2023-02-21 13:12:43.786564 => 2023-02-21 13:12:43.786568
[0m13:12:43.786903 [debug] [Thread-1  ]: Finished running node model.test_dbt.my_first_dbt_model
[0m13:12:43.787260 [debug] [Thread-1  ]: Began running node model.test_dbt.metric_test
[0m13:12:43.787526 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.test_dbt.metric_test'
[0m13:12:43.787628 [debug] [Thread-1  ]: Began compiling node model.test_dbt.metric_test
[0m13:12:43.905687 [debug] [Thread-1  ]: Writing injected SQL for node "model.test_dbt.metric_test"
[0m13:12:43.909057 [debug] [Thread-1  ]: Timing info for model.test_dbt.metric_test (compile): 2023-02-21 13:12:43.787701 => 2023-02-21 13:12:43.909005
[0m13:12:43.909240 [debug] [Thread-1  ]: Began executing node model.test_dbt.metric_test
[0m13:12:43.909344 [debug] [Thread-1  ]: Timing info for model.test_dbt.metric_test (execute): 2023-02-21 13:12:43.909320 => 2023-02-21 13:12:43.909327
[0m13:12:43.909685 [debug] [Thread-1  ]: Finished running node model.test_dbt.metric_test
[0m13:12:43.909833 [debug] [Thread-1  ]: Began running node model.test_dbt.my_second_dbt_model
[0m13:12:43.910133 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.test_dbt.my_second_dbt_model'
[0m13:12:43.910271 [debug] [Thread-1  ]: Began compiling node model.test_dbt.my_second_dbt_model
[0m13:12:43.911910 [debug] [Thread-1  ]: Writing injected SQL for node "model.test_dbt.my_second_dbt_model"
[0m13:12:43.912244 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_second_dbt_model (compile): 2023-02-21 13:12:43.910356 => 2023-02-21 13:12:43.912218
[0m13:12:43.912357 [debug] [Thread-1  ]: Began executing node model.test_dbt.my_second_dbt_model
[0m13:12:43.912446 [debug] [Thread-1  ]: Timing info for model.test_dbt.my_second_dbt_model (execute): 2023-02-21 13:12:43.912427 => 2023-02-21 13:12:43.912431
[0m13:12:43.912730 [debug] [Thread-1  ]: Finished running node model.test_dbt.my_second_dbt_model
[0m13:12:43.912860 [debug] [Thread-1  ]: Began running node test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:12:43.913160 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710'
[0m13:12:43.913254 [debug] [Thread-1  ]: Began compiling node test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:12:43.920296 [debug] [Thread-1  ]: Writing injected SQL for node "test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:12:43.921069 [debug] [Thread-1  ]: Timing info for test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 2023-02-21 13:12:43.913320 => 2023-02-21 13:12:43.921000
[0m13:12:43.921287 [debug] [Thread-1  ]: Began executing node test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:12:43.921399 [debug] [Thread-1  ]: Timing info for test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 2023-02-21 13:12:43.921374 => 2023-02-21 13:12:43.921381
[0m13:12:43.921765 [debug] [Thread-1  ]: Finished running node test.test_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:12:43.921922 [debug] [Thread-1  ]: Began running node test.test_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:12:43.922448 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.test_dbt.unique_my_first_dbt_model_id.16e066b321'
[0m13:12:43.922630 [debug] [Thread-1  ]: Began compiling node test.test_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:12:43.926746 [debug] [Thread-1  ]: Writing injected SQL for node "test.test_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m13:12:43.927266 [debug] [Thread-1  ]: Timing info for test.test_dbt.unique_my_first_dbt_model_id.16e066b321 (compile): 2023-02-21 13:12:43.922711 => 2023-02-21 13:12:43.927231
[0m13:12:43.927404 [debug] [Thread-1  ]: Began executing node test.test_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:12:43.927504 [debug] [Thread-1  ]: Timing info for test.test_dbt.unique_my_first_dbt_model_id.16e066b321 (execute): 2023-02-21 13:12:43.927482 => 2023-02-21 13:12:43.927488
[0m13:12:43.927833 [debug] [Thread-1  ]: Finished running node test.test_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:12:43.927983 [debug] [Thread-1  ]: Began running node test.test_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:12:43.928223 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.test_dbt.not_null_my_second_dbt_model_id.151b76d778'
[0m13:12:43.928326 [debug] [Thread-1  ]: Began compiling node test.test_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:12:43.930817 [debug] [Thread-1  ]: Writing injected SQL for node "test.test_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m13:12:43.931807 [debug] [Thread-1  ]: Timing info for test.test_dbt.not_null_my_second_dbt_model_id.151b76d778 (compile): 2023-02-21 13:12:43.928396 => 2023-02-21 13:12:43.931774
[0m13:12:43.931941 [debug] [Thread-1  ]: Began executing node test.test_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:12:43.932039 [debug] [Thread-1  ]: Timing info for test.test_dbt.not_null_my_second_dbt_model_id.151b76d778 (execute): 2023-02-21 13:12:43.932017 => 2023-02-21 13:12:43.932023
[0m13:12:43.932360 [debug] [Thread-1  ]: Finished running node test.test_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:12:43.932500 [debug] [Thread-1  ]: Began running node test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:12:43.932731 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493'
[0m13:12:43.932832 [debug] [Thread-1  ]: Began compiling node test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:12:43.935213 [debug] [Thread-1  ]: Writing injected SQL for node "test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:12:43.935993 [debug] [Thread-1  ]: Timing info for test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493 (compile): 2023-02-21 13:12:43.932903 => 2023-02-21 13:12:43.935936
[0m13:12:43.936194 [debug] [Thread-1  ]: Began executing node test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:12:43.936307 [debug] [Thread-1  ]: Timing info for test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493 (execute): 2023-02-21 13:12:43.936283 => 2023-02-21 13:12:43.936288
[0m13:12:43.936661 [debug] [Thread-1  ]: Finished running node test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:12:43.937517 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:12:43.937690 [debug] [MainThread]: Connection 'test.test_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m13:12:43.937979 [debug] [MainThread]: Command end result
[0m13:12:43.943814 [info ] [MainThread]: Done.
[0m13:12:43.944099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10567d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10574a880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10574a520>]}
[0m13:12:43.944309 [debug] [MainThread]: Flushing usage events
